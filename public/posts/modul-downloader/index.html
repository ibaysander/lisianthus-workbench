<!doctype html><html lang=en dir=auto><head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Universitas Terbuka Modul Downloader Into Image | Labrat</title>
<meta name=keywords content="kuliah"><meta name=description content="Desc Text."><meta name=author content="lisianthus"><link rel=canonical href=https://canonical.url/to/page><link crossorigin=anonymous href=/assets/css/stylesheet.45e028aa8ce0961349adf411b013ee39406be2c0bc80d4ea3fc04555f7f4611a.css integrity="sha256-ReAoqozglhNJrfQRsBPuOUBr4sC8gNTqP8BFVff0YRo=" rel="preload stylesheet" as=style><link rel=icon href=http://labrat-vm:1313/%3Clink%20/%20abs%20url%3E><link rel=icon type=image/png sizes=16x16 href=http://labrat-vm:1313/%3Clink%20/%20abs%20url%3E><link rel=icon type=image/png sizes=32x32 href=http://labrat-vm:1313/%3Clink%20/%20abs%20url%3E><link rel=apple-touch-icon href=http://labrat-vm:1313/%3Clink%20/%20abs%20url%3E><link rel=mask-icon href=http://labrat-vm:1313/%3Clink%20/%20abs%20url%3E><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=http://labrat-vm:1313/posts/modul-downloader/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><meta property="og:url" content="http://labrat-vm:1313/posts/modul-downloader/"><meta property="og:site_name" content="Labrat"><meta property="og:title" content="Universitas Terbuka Modul Downloader Into Image"><meta property="og:description" content="Desc Text."><meta property="og:locale" content="en"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2025-02-06T10:09:33+07:00"><meta property="article:modified_time" content="2025-02-06T10:09:33+07:00"><meta property="article:tag" content="Kuliah"><meta property="og:image" content="http://labrat-vm:1313/%3Cimage%20path/url%3E"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="http://labrat-vm:1313/%3Cimage%20path/url%3E"><meta name=twitter:title content="Universitas Terbuka Modul Downloader Into Image"><meta name=twitter:description content="Desc Text."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"http://labrat-vm:1313/posts/"},{"@type":"ListItem","position":2,"name":"Universitas Terbuka Modul Downloader Into Image","item":"http://labrat-vm:1313/posts/modul-downloader/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Universitas Terbuka Modul Downloader Into Image","name":"Universitas Terbuka Modul Downloader Into Image","description":"Desc Text.","keywords":["kuliah"],"articleBody":"This PowerShell script is designed to download pages from a document hosted on a web service, save them as PNG files, and handle various edge cases such as retries, existing files, and small files. Below is a breakdown of the script’s functionality and how it works:\nKey Components of the Script Download-Page Function:\nDownloads a single page from a given URL with retry logic. Skips downloading if the file already exists and is larger than 10KB. Uses Invoke-WebRequest to fetch the page and save it as a PNG file. Retries up to $MaxRetries times if the download fails, with a delay of $RetryDelay seconds between attempts. Process-Document Function:\nProcesses a single document by iterating through its pages. Constructs the URL for each page using the doc parameter, subfolder, and page number. Checks if the file already exists and is valid before attempting to download. Stops processing if it encounters a series of small files (less than 10KB) or if the download fails after retries. Tracks the number of downloaded pages, existing files, and small files. Main Script Execution:\nPrompts the user for a subfolder name (e.g., MSIM4309). Creates an output directory for the downloaded files. Loops through a range of doc parameters (e.g., M1 to M11) and processes each document using the Process-Document function. Stops the script if no pages are downloaded for a document or if the script reaches the end of the document range. How the Script Works User Input:\nThe script prompts the user to enter a subfolder name, which is used to construct the URLs and organize the output files. Output Directory:\nThe script creates a directory named after the subfolder to store the downloaded PNG files. If the directory already exists, it uses the existing one. Document Processing:\nThe script loops through a predefined range of doc parameters (e.g., M1 to M11). For each document, it constructs the URL for each page and attempts to download it using the Download-Page function. If a file already exists and is valid (larger than 10KB), it skips the download. If a file is smaller than 10KB, it removes the file and increments a counter. If the counter reaches a threshold ($maxSmallFiles), the script stops processing the current document. Retry Logic:\nIf a download fails, the script retries up to $MaxRetries times with a delay of $RetryDelay seconds between attempts. If all retries fail, the script logs the error and moves on to the next page or document. Stopping Conditions:\nThe script stops processing a document if it encounters too many small files or if the download fails after retries. If no pages are downloaded for a document and the script fails in the first few pages, it stops the entire script. Completion:\nOnce all documents are processed, the script outputs a completion message and indicates where the files are saved. Example Usage Input:\nWhen prompted, enter a subfolder name, e.g., MSIM4309. Output:\nThe script creates a folder named MSIM4309 and downloads pages for documents M1 to M11 (or the specified range). Each page is saved as a PNG file with a filename like M1_Page_1.png, M1_Page_2.png, etc. Logs:\nThe script logs its progress, including skipped files, successful downloads, and errors. Customization PHPSESSID:\nUpdate the PHPSESSID in the $headers hashtable if necessary. This is required for authentication with the web service. Range of doc Parameters:\nAdjust the $startNumber and $endNumber variables to process a different range of documents. Retry Settings:\nModify $MaxRetries and $RetryDelay in the Download-Page function to change the retry behavior. Small File Threshold:\nAdjust the $maxSmallFiles variable in the Process-Document function to change the number of consecutive small files allowed before stopping. Error Handling The script handles errors such as failed downloads, invalid files, and missing directories. It logs errors and provides clear messages to the user. Output Example Enter the subfolder name (e.g., MSIM4309): MSIM4309 Created directory: MSIM4309 --- Processing document: M1 --- ⏭️ File already exists and is valid: MSIM4309\\M1_Page_1.png ✅ Successfully downloaded M1 Page 2 ⚠️ Page 3 is less than 10KB (512 bytes) ✅ Successfully downloaded M1 Page 4 ... ✅ Download process completed for doc 'M1'. Total pages: 10 (2 existing, 8 new) --- Processing document: M2 --- ... ✅ Script completed. All files are saved in the 'MSIM4309' folder. ","wordCount":"708","inLanguage":"en","image":"http://labrat-vm:1313/%3Cimage%20path/url%3E","datePublished":"2025-02-06T10:09:33+07:00","dateModified":"2025-02-06T10:09:33+07:00","author":{"@type":"Person","name":"lisianthus"},"mainEntityOfPage":{"@type":"WebPage","@id":"http://labrat-vm:1313/posts/modul-downloader/"},"publisher":{"@type":"Organization","name":"Labrat","logo":{"@type":"ImageObject","url":"http://labrat-vm:1313/%3Clink%20/%20abs%20url%3E"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=http://labrat-vm:1313/ accesskey=h title="labraaat (Alt + H)"><img src=http://labrat-vm:1313/apple-touch-icon.png alt aria-label=logo height=35>labraaat</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=http://labrat-vm:1313/posts/ title=posts><span>posts</span></a></li><li><a href=http://labrat-vm:1313/tags/ title=tags><span>tags</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=http://labrat-vm:1313/>Home</a>&nbsp;»&nbsp;<a href=http://labrat-vm:1313/posts/>Posts</a></div><h1 class="post-title entry-hint-parent">Universitas Terbuka Modul Downloader Into Image</h1><div class=post-description>Desc Text.</div><div class=post-meta><span title='2025-02-06 10:09:33 +0700 WIB'>February 6, 2025</span>&nbsp;·&nbsp;708 words&nbsp;·&nbsp;lisianthus&nbsp;|&nbsp;<a href=https://github.com/%3cpath_to_repo%3e/content/posts/modul-downloader.md rel="noopener noreferrer" target=_blank>Suggest Changes</a></div></header><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><nav id=TableOfContents><ul><li><ul><li><a href=#key-components-of-the-script><strong>Key Components of the Script</strong></a></li><li><a href=#how-the-script-works><strong>How the Script Works</strong></a></li><li><a href=#example-usage><strong>Example Usage</strong></a></li><li><a href=#customization><strong>Customization</strong></a></li><li><a href=#error-handling><strong>Error Handling</strong></a></li><li><a href=#output-example><strong>Output Example</strong></a></li></ul></li></ul></nav></div></details></div><div class=post-content><p>This PowerShell script is designed to download pages from a document hosted on a web service, save them as PNG files, and handle various edge cases such as retries, existing files, and small files. Below is a breakdown of the script&rsquo;s functionality and how it works:</p><hr><h3 id=key-components-of-the-script><strong>Key Components of the Script</strong><a hidden class=anchor aria-hidden=true href=#key-components-of-the-script>#</a></h3><ol><li><p><strong><code>Download-Page</code> Function</strong>:</p><ul><li>Downloads a single page from a given URL with retry logic.</li><li>Skips downloading if the file already exists and is larger than 10KB.</li><li>Uses <code>Invoke-WebRequest</code> to fetch the page and save it as a PNG file.</li><li>Retries up to <code>$MaxRetries</code> times if the download fails, with a delay of <code>$RetryDelay</code> seconds between attempts.</li></ul></li><li><p><strong><code>Process-Document</code> Function</strong>:</p><ul><li>Processes a single document by iterating through its pages.</li><li>Constructs the URL for each page using the <code>doc</code> parameter, <code>subfolder</code>, and <code>page</code> number.</li><li>Checks if the file already exists and is valid before attempting to download.</li><li>Stops processing if it encounters a series of small files (less than 10KB) or if the download fails after retries.</li><li>Tracks the number of downloaded pages, existing files, and small files.</li></ul></li><li><p><strong>Main Script Execution</strong>:</p><ul><li>Prompts the user for a <code>subfolder</code> name (e.g., <code>MSIM4309</code>).</li><li>Creates an output directory for the downloaded files.</li><li>Loops through a range of <code>doc</code> parameters (e.g., <code>M1</code> to <code>M11</code>) and processes each document using the <code>Process-Document</code> function.</li><li>Stops the script if no pages are downloaded for a document or if the script reaches the end of the document range.</li></ul></li></ol><hr><h3 id=how-the-script-works><strong>How the Script Works</strong><a hidden class=anchor aria-hidden=true href=#how-the-script-works>#</a></h3><ol><li><p><strong>User Input</strong>:</p><ul><li>The script prompts the user to enter a <code>subfolder</code> name, which is used to construct the URLs and organize the output files.</li></ul></li><li><p><strong>Output Directory</strong>:</p><ul><li>The script creates a directory named after the <code>subfolder</code> to store the downloaded PNG files. If the directory already exists, it uses the existing one.</li></ul></li><li><p><strong>Document Processing</strong>:</p><ul><li>The script loops through a predefined range of <code>doc</code> parameters (e.g., <code>M1</code> to <code>M11</code>).</li><li>For each document, it constructs the URL for each page and attempts to download it using the <code>Download-Page</code> function.</li><li>If a file already exists and is valid (larger than 10KB), it skips the download.</li><li>If a file is smaller than 10KB, it removes the file and increments a counter. If the counter reaches a threshold (<code>$maxSmallFiles</code>), the script stops processing the current document.</li></ul></li><li><p><strong>Retry Logic</strong>:</p><ul><li>If a download fails, the script retries up to <code>$MaxRetries</code> times with a delay of <code>$RetryDelay</code> seconds between attempts.</li><li>If all retries fail, the script logs the error and moves on to the next page or document.</li></ul></li><li><p><strong>Stopping Conditions</strong>:</p><ul><li>The script stops processing a document if it encounters too many small files or if the download fails after retries.</li><li>If no pages are downloaded for a document and the script fails in the first few pages, it stops the entire script.</li></ul></li><li><p><strong>Completion</strong>:</p><ul><li>Once all documents are processed, the script outputs a completion message and indicates where the files are saved.</li></ul></li></ol><hr><h3 id=example-usage><strong>Example Usage</strong><a hidden class=anchor aria-hidden=true href=#example-usage>#</a></h3><ol><li><p><strong>Input</strong>:</p><ul><li>When prompted, enter a subfolder name, e.g., <code>MSIM4309</code>.</li></ul></li><li><p><strong>Output</strong>:</p><ul><li>The script creates a folder named <code>MSIM4309</code> and downloads pages for documents <code>M1</code> to <code>M11</code> (or the specified range).</li><li>Each page is saved as a PNG file with a filename like <code>M1_Page_1.png</code>, <code>M1_Page_2.png</code>, etc.</li></ul></li><li><p><strong>Logs</strong>:</p><ul><li>The script logs its progress, including skipped files, successful downloads, and errors.</li></ul></li></ol><hr><h3 id=customization><strong>Customization</strong><a hidden class=anchor aria-hidden=true href=#customization>#</a></h3><ul><li><p><strong>PHPSESSID</strong>:</p><ul><li>Update the <code>PHPSESSID</code> in the <code>$headers</code> hashtable if necessary. This is required for authentication with the web service.</li></ul></li><li><p><strong>Range of <code>doc</code> Parameters</strong>:</p><ul><li>Adjust the <code>$startNumber</code> and <code>$endNumber</code> variables to process a different range of documents.</li></ul></li><li><p><strong>Retry Settings</strong>:</p><ul><li>Modify <code>$MaxRetries</code> and <code>$RetryDelay</code> in the <code>Download-Page</code> function to change the retry behavior.</li></ul></li><li><p><strong>Small File Threshold</strong>:</p><ul><li>Adjust the <code>$maxSmallFiles</code> variable in the <code>Process-Document</code> function to change the number of consecutive small files allowed before stopping.</li></ul></li></ul><hr><h3 id=error-handling><strong>Error Handling</strong><a hidden class=anchor aria-hidden=true href=#error-handling>#</a></h3><ul><li>The script handles errors such as failed downloads, invalid files, and missing directories.</li><li>It logs errors and provides clear messages to the user.</li></ul><hr><h3 id=output-example><strong>Output Example</strong><a hidden class=anchor aria-hidden=true href=#output-example>#</a></h3><pre tabindex=0><code>Enter the subfolder name (e.g., MSIM4309): MSIM4309
Created directory: MSIM4309

--- Processing document: M1 ---
⏭️ File already exists and is valid: MSIM4309\M1_Page_1.png
✅ Successfully downloaded M1 Page 2
⚠️ Page 3 is less than 10KB (512 bytes)
✅ Successfully downloaded M1 Page 4
...

✅ Download process completed for doc &#39;M1&#39;.
Total pages: 10 (2 existing, 8 new)

--- Processing document: M2 ---
...

✅ Script completed. All files are saved in the &#39;MSIM4309&#39; folder.
</code></pre></div><footer class=post-footer><ul class=post-tags><li><a href=http://labrat-vm:1313/tags/kuliah/>Kuliah</a></li></ul><nav class=paginav><a class=prev href=http://labrat-vm:1313/posts/wso2/analogy-api-restaurant/><span class=title>« Prev</span><br><span>WSO2 API Manager: Mengelola API Seperti Restoran Bintang Lima</span>
</a><a class=next href=http://labrat-vm:1313/posts/updated-reverse-pdf/><span class=title>Next »</span><br><span>Updated Reverse Pdf</span></a></nav></footer></article></main><footer class=footer><span>&copy; 2025 <a href=http://labrat-vm:1313/>Labrat</a></span> ·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script></body></html>