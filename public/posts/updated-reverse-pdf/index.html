<!doctype html><html lang=en dir=auto><head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Updated Reverse Pdf | Labrat</title>
<meta name=keywords content="kuliah"><meta name=description content="Desc Text."><meta name=author content="lisianthus"><link rel=canonical href=https://canonical.url/to/page><link crossorigin=anonymous href=/assets/css/stylesheet.45e028aa8ce0961349adf411b013ee39406be2c0bc80d4ea3fc04555f7f4611a.css integrity="sha256-ReAoqozglhNJrfQRsBPuOUBr4sC8gNTqP8BFVff0YRo=" rel="preload stylesheet" as=style><link rel=icon href=http://labrat-vm:1313/%3Clink%20/%20abs%20url%3E><link rel=icon type=image/png sizes=16x16 href=http://labrat-vm:1313/%3Clink%20/%20abs%20url%3E><link rel=icon type=image/png sizes=32x32 href=http://labrat-vm:1313/%3Clink%20/%20abs%20url%3E><link rel=apple-touch-icon href=http://labrat-vm:1313/%3Clink%20/%20abs%20url%3E><link rel=mask-icon href=http://labrat-vm:1313/%3Clink%20/%20abs%20url%3E><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=http://labrat-vm:1313/posts/updated-reverse-pdf/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><meta property="og:url" content="http://labrat-vm:1313/posts/updated-reverse-pdf/"><meta property="og:site_name" content="Labrat"><meta property="og:title" content="Updated Reverse Pdf"><meta property="og:description" content="Desc Text."><meta property="og:locale" content="en"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2025-02-05T10:41:32+07:00"><meta property="article:modified_time" content="2025-02-05T10:41:32+07:00"><meta property="article:tag" content="Kuliah"><meta property="og:image" content="http://labrat-vm:1313/%3Cimage%20path/url%3E"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="http://labrat-vm:1313/%3Cimage%20path/url%3E"><meta name=twitter:title content="Updated Reverse Pdf"><meta name=twitter:description content="Desc Text."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"http://labrat-vm:1313/posts/"},{"@type":"ListItem","position":2,"name":"Updated Reverse Pdf","item":"http://labrat-vm:1313/posts/updated-reverse-pdf/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Updated Reverse Pdf","name":"Updated Reverse Pdf","description":"Desc Text.","keywords":["kuliah"],"articleBody":"1. Updated Workflow Overview Here’s the enhanced workflow your Python application will follow:\nIdentify and Process Images:\nConvert each image (.jpeg, .jpg, .png, etc.) to a searchable PDF using Tesseract OCR. Extract text from each image and save it as a .txt file. Merge Outputs:\nCombine all individual PDFs into one comprehensive PDF. Concatenate all individual text files into a single text document. Optional Cleanup:\nDelete individual PDFs and text files after merging, based on user preference. 2. Enhanced Python Script Below is the complete Python script, convert_and_merge.py, incorporating all the desired functionalities:\n# convert_and_merge.py import os import sys import subprocess from pathlib import Path from typing import List import argparse import logging import pytesseract from PyPDF2 import PdfMerger from tqdm import tqdm def setup_logging(): \"\"\" Sets up logging to file with INFO level. \"\"\" logging.basicConfig( filename='convert_and_merge.log', filemode='a', format='%(asctime)s - %(levelname)s - %(message)s', level=logging.INFO ) def parse_arguments(): \"\"\" Parses command-line arguments. Returns: argparse.Namespace: Parsed arguments. \"\"\" parser = argparse.ArgumentParser( description=\"Convert images to searchable PDFs and text files using Tesseract OCR, then merge them.\" ) parser.add_argument( '-i', '--input_dir', type=str, help='Directory containing input images.' ) parser.add_argument( '-o', '--output_pdf', type=str, help='Filename for the merged output PDF. Defaults to \"combined_document.pdf\".' ) parser.add_argument( '-t', '--output_txt', type=str, help='Filename for the merged output text file. Defaults to \"combined_text.txt\".' ) parser.add_argument( '-l', '--languages', type=str, help='Languages for OCR separated by +, e.g., \"eng+ind\". Defaults to \"eng+ind\".' ) parser.add_argument( '-e', '--extension', type=str, help='Image file extension to process, e.g., \".jpeg\", \".jpg\", \".png\". Defaults to \".jpeg\".' ) parser.add_argument( '-c', '--cleanup', action='store_true', help='Cleanup individual PDFs and text files after merging.' ) parser.add_argument( '-r', '--range', type=str, help='Range of image numbers to process, e.g., \"1-58\". Defaults to \"1-58\".' ) return parser.parse_args() def prompt_user_inputs(args): \"\"\" Prompt user for inputs if they are not provided via command-line arguments. Args: args (argparse.Namespace): Parsed arguments. \"\"\" if not args.input_dir: args.input_dir = input(\"Enter the directory containing the input images (e.g., C:/Users/Username/Images): \").strip() if not args.output_pdf: args.output_pdf = input(\"Enter the desired name for the merged output PDF (default: combined_document.pdf): \").strip() if not args.output_pdf: args.output_pdf = \"combined_document.pdf\" if not args.output_txt: args.output_txt = input(\"Enter the desired name for the merged output text file (default: combined_text.txt): \").strip() if not args.output_txt: args.output_txt = \"combined_text.txt\" if not args.languages: args.languages = input(\"Enter OCR languages separated by + (e.g., eng+ind) [default: eng+ind]: \").strip() if not args.languages: args.languages = \"eng+ind\" if not args.extension: args.extension = input(\"Enter the image file extension to process (e.g., .jpeg, .jpg, .png) [default: .jpeg]: \").strip() if not args.extension: args.extension = \".jpeg\" if not args.range: args.range = input(\"Enter the range of image numbers to process (e.g., 1-58) [default: 1-58]: \").strip() if not args.range: args.range = \"1-58\" # Confirm cleanup option if not provided if not args.cleanup: cleanup_input = input(\"Do you want to cleanup individual PDFs and text files after merging? (y/n) [default: n]: \").strip().lower() args.cleanup = cleanup_input == 'y' def convert_image_to_pdf(image_path: Path, output_pdf_path: Path, languages: str = \"eng+ind\"): \"\"\" Converts an image to a searchable PDF using Tesseract OCR. Args: image_path (Path): Path to the input image. output_pdf_path (Path): Path to save the output PDF. languages (str, optional): Languages for Tesseract OCR. Defaults to \"eng+ind\". \"\"\" try: if not image_path.exists(): logging.warning(f\"Image file {image_path} does not exist.\") return command = [ 'tesseract', str(image_path), str(output_pdf_path.with_suffix('')), # Tesseract appends .pdf '-l', languages, 'pdf' ] subprocess.run(command, check=True, stdout=subprocess.PIPE, stderr=subprocess.PIPE) logging.info(f\"Converted {image_path} to {output_pdf_path}\") except subprocess.CalledProcessError as e: logging.error(f\"Error processing {image_path}: {e.stderr.decode().strip()}\") except Exception as e: logging.error(f\"Unexpected error processing {image_path}: {e}\") def extract_text_from_image(image_path: Path, output_txt_path: Path, languages: str = \"eng+ind\"): \"\"\" Extracts text from an image using pytesseract and saves it to a text file. Args: image_path (Path): Path to the input image. output_txt_path (Path): Path to save the extracted text. languages (str, optional): Languages for OCR. Defaults to \"eng+ind\". \"\"\" try: if not image_path.exists(): logging.warning(f\"Image file {image_path} does not exist.\") return # Open the image using PIL from PIL import Image img = Image.open(image_path) # Use pytesseract to do OCR on the image text = pytesseract.image_to_string(img, lang=languages) # Write the extracted text to the txt file with open(output_txt_path, 'w', encoding='utf-8') as f: f.write(text) logging.info(f\"Extracted text from {image_path} to {output_txt_path}\") except Exception as e: logging.error(f\"Error extracting text from {image_path}: {e}\") def merge_pdfs(pdf_paths: List[Path], output_path: Path): \"\"\" Merges multiple PDFs into a single PDF. Args: pdf_paths (List[Path]): List of PDF file paths to merge. output_path (Path): Path to save the merged PDF. \"\"\" merger = PdfMerger() try: for pdf in pdf_paths: if pdf.exists(): merger.append(str(pdf)) logging.info(f\"Appended {pdf} to merger.\") else: logging.warning(f\"PDF file {pdf} does not exist and will be skipped.\") merger.write(str(output_path)) merger.close() logging.info(f\"Merged PDF saved as {output_path}\") except Exception as e: logging.error(f\"Error merging PDFs: {e}\") merger.close() def merge_texts(txt_paths: List[Path], output_path: Path): \"\"\" Merges multiple text files into a single text file. Args: txt_paths (List[Path]): List of text file paths to merge. output_path (Path): Path to save the merged text file. \"\"\" try: with open(output_path, 'w', encoding='utf-8') as outfile: for txt in txt_paths: if txt.exists(): with open(txt, 'r', encoding='utf-8') as infile: outfile.write(infile.read()) outfile.write(\"\\n\\n--- End of Page ---\\n\\n\") # Separator between pages logging.info(f\"Appended {txt} to {output_path}\") else: logging.warning(f\"Text file {txt} does not exist and will be skipped.\") logging.info(f\"Merged text file saved as {output_path}\") except Exception as e: logging.error(f\"Error merging text files: {e}\") def main(): \"\"\" Main function to convert images to PDFs and text files, then merge them. \"\"\" setup_logging() args = parse_arguments() # If any required arguments are missing, prompt the user if not (args.input_dir and args.output_pdf and args.output_txt and args.languages and args.extension and args.range): print(\"Some required arguments are missing. You will be prompted to enter them.\") prompt_user_inputs(args) else: # Even if arguments are provided, confirm cleanup preference if not args.cleanup: cleanup_input = input(\"Do you want to cleanup individual PDFs and text files after merging? (y/n) [default: n]: \").strip().lower() args.cleanup = cleanup_input == 'y' # Validate and convert input directory to Path images_dir = Path(args.input_dir).expanduser().resolve() if not images_dir.is_dir(): print(f\"Error: The input directory '{images_dir}' does not exist or is not a directory.\") logging.error(f\"Invalid input directory: {images_dir}\") sys.exit(1) # Define the output merged PDF and text file paths merged_pdf_path = images_dir / args.output_pdf merged_txt_path = images_dir / args.output_txt # Define languages for OCR languages = args.languages # Define the range of images try: start, end = map(int, args.range.split('-')) if start \u003e end: print(\"Error: Start of range cannot be greater than end.\") logging.error(\"Invalid range: start greater than end.\") sys.exit(1) image_files = [images_dir / f\"{i}{args.extension}\" for i in range(start, end + 1)] except ValueError: print(\"Error: Invalid range format. Use start-end, e.g., 1-58.\") logging.error(\"Invalid range format provided.\") sys.exit(1) # Define lists to store individual PDF and text paths individual_pdfs = [] individual_txts = [] print(\"\\nStarting conversion of images to PDFs and text files...\") logging.info(\"Starting conversion of images to PDFs and text files.\") for image_path in tqdm(image_files, desc=\"Processing Images\", unit=\"image\"): # Define output paths output_pdf = image_path.with_suffix('.pdf') output_txt = image_path.with_suffix('.txt') # Convert image to PDF convert_image_to_pdf(image_path, output_pdf, languages) if output_pdf.exists(): individual_pdfs.append(output_pdf) else: logging.warning(f\"Failed to create PDF for {image_path}\") # Extract text from image to txt extract_text_from_image(image_path, output_txt, languages) if output_txt.exists(): individual_txts.append(output_txt) else: logging.warning(f\"Failed to create text file for {image_path}\") print(\"\\nConversion complete.\\nStarting merging of PDFs and text files...\") logging.info(\"Conversion complete. Starting merging of PDFs and text files.\") # Sort PDFs and text files based on numerical order def extract_number(file: Path) -\u003e int: try: return int(file.stem) except ValueError: logging.warning(f\"Non-numeric filename: {file.name}. Assigning sorting key 0.\") return 0 # Assign 0 or handle differently individual_pdfs_sorted = sorted(individual_pdfs, key=extract_number) individual_txts_sorted = sorted(individual_txts, key=extract_number) # Merge PDFs merge_pdfs(individual_pdfs_sorted, merged_pdf_path) # Merge Text Files merge_texts(individual_txts_sorted, merged_txt_path) print(f\"\\nMerged PDF saved as {merged_pdf_path}\") print(f\"Merged text file saved as {merged_txt_path}\") logging.info(f\"Merged PDF saved as {merged_pdf_path}\") logging.info(f\"Merged text file saved as {merged_txt_path}\") if args.cleanup: print(\"\\nCleaning up individual PDF and text files...\") logging.info(\"Starting cleanup of individual PDF and text files.\") for pdf in individual_pdfs_sorted: try: pdf.unlink() print(f\"Deleted {pdf}\") logging.info(f\"Deleted {pdf}\") except Exception as e: print(f\"Error deleting {pdf}: {e}\") logging.error(f\"Error deleting {pdf}: {e}\") for txt in individual_txts_sorted: try: txt.unlink() print(f\"Deleted {txt}\") logging.info(f\"Deleted {txt}\") except Exception as e: print(f\"Error deleting {txt}: {e}\") logging.error(f\"Error deleting {txt}: {e}\") print(\"\\nProcess completed successfully!\") logging.info(\"Process completed successfully.\") if __name__ == \"__main__\": main() 3. Detailed Explanation of Enhancements 3.1. Dual Conversion: PDF and Text Files To meet your requirement of generating both searchable PDFs and accompanying text files, two key functions have been added:\nconvert_image_to_pdf:\nUtilizes Tesseract via a subprocess call to convert each image into a searchable PDF. Ensures that the OCR layer is embedded within the PDF for text selection. extract_text_from_image:\nUses pytesseract to extract raw text from each image. Saves the extracted text to a .txt file. This provides a separate text file that can be referenced or used independently of the PDF. 3.2. Merging Functionality Expanded In addition to merging individual PDFs into a single PDF, the script also merges individual text files into a single comprehensive text document:\nmerge_pdfs:\nRemains largely the same, appending each individual PDF in numerical order to ensure the final merged PDF maintains the correct sequence. merge_texts:\nIntroduced to concatenate all individual text files into one. Inserts a clear separator (--- End of Page ---) between each page’s content for better readability. 3.3. Interactive Prompts for Enhanced User-Friendliness The script now intelligently prompts users for any missing information instead of relying solely on command-line arguments. This ensures that even users unfamiliar with command-line operations can effectively use the tool.\n3.4. Logging for Better Monitoring and Debugging Comprehensive logging has been integrated:\nLog File: All operations, successes, warnings, and errors are logged to convert_and_merge.log. Console Feedback: Users receive real-time feedback on the conversion and merging processes. 3.5. Cleanup Functionality An optional cleanup feature allows users to delete individual PDFs and text files after successfully merging them, reducing clutter and saving disk space.\n","wordCount":"1581","inLanguage":"en","image":"http://labrat-vm:1313/%3Cimage%20path/url%3E","datePublished":"2025-02-05T10:41:32+07:00","dateModified":"2025-02-05T10:41:32+07:00","author":{"@type":"Person","name":"lisianthus"},"mainEntityOfPage":{"@type":"WebPage","@id":"http://labrat-vm:1313/posts/updated-reverse-pdf/"},"publisher":{"@type":"Organization","name":"Labrat","logo":{"@type":"ImageObject","url":"http://labrat-vm:1313/%3Clink%20/%20abs%20url%3E"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=http://labrat-vm:1313/ accesskey=h title="labraaat (Alt + H)"><img src=http://labrat-vm:1313/apple-touch-icon.png alt aria-label=logo height=35>labraaat</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=http://labrat-vm:1313/posts/ title=posts><span>posts</span></a></li><li><a href=http://labrat-vm:1313/tags/ title=tags><span>tags</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=http://labrat-vm:1313/>Home</a>&nbsp;»&nbsp;<a href=http://labrat-vm:1313/posts/>Posts</a></div><h1 class="post-title entry-hint-parent">Updated Reverse Pdf</h1><div class=post-description>Desc Text.</div><div class=post-meta><span title='2025-02-05 10:41:32 +0700 WIB'>February 5, 2025</span>&nbsp;·&nbsp;1581 words&nbsp;·&nbsp;lisianthus&nbsp;|&nbsp;<a href=https://github.com/%3cpath_to_repo%3e/content/posts/updated-reverse-pdf.md rel="noopener noreferrer" target=_blank>Suggest Changes</a></div></header><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><nav id=TableOfContents><ul><li><a href=#1-updated-workflow-overview><strong>1. Updated Workflow Overview</strong></a></li><li><a href=#2-enhanced-python-script><strong>2. Enhanced Python Script</strong></a></li><li><a href=#3-detailed-explanation-of-enhancements><strong>3. Detailed Explanation of Enhancements</strong></a><ul><li><a href=#31-dual-conversion-pdf-and-text-files><strong>3.1. Dual Conversion: PDF and Text Files</strong></a></li><li><a href=#32-merging-functionality-expanded><strong>3.2. Merging Functionality Expanded</strong></a></li><li><a href=#33-interactive-prompts-for-enhanced-user-friendliness><strong>3.3. Interactive Prompts for Enhanced User-Friendliness</strong></a></li><li><a href=#34-logging-for-better-monitoring-and-debugging><strong>3.4. Logging for Better Monitoring and Debugging</strong></a></li><li><a href=#35-cleanup-functionality><strong>3.5. Cleanup Functionality</strong></a></li></ul></li></ul></nav></div></details></div><div class=post-content><h2 id=1-updated-workflow-overview><strong>1. Updated Workflow Overview</strong><a hidden class=anchor aria-hidden=true href=#1-updated-workflow-overview>#</a></h2><p>Here&rsquo;s the enhanced workflow your Python application will follow:</p><ol><li><p><strong>Identify and Process Images:</strong></p><ul><li>Convert each image (<code>.jpeg</code>, <code>.jpg</code>, <code>.png</code>, etc.) to a searchable PDF using Tesseract OCR.</li><li>Extract text from each image and save it as a <code>.txt</code> file.</li></ul></li><li><p><strong>Merge Outputs:</strong></p><ul><li>Combine all individual PDFs into one comprehensive PDF.</li><li>Concatenate all individual text files into a single text document.</li></ul></li><li><p><strong>Optional Cleanup:</strong></p><ul><li>Delete individual PDFs and text files after merging, based on user preference.</li></ul></li></ol><hr><h2 id=2-enhanced-python-script><strong>2. Enhanced Python Script</strong><a hidden class=anchor aria-hidden=true href=#2-enhanced-python-script>#</a></h2><p>Below is the complete Python script, <code>convert_and_merge.py</code>, incorporating all the desired functionalities:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># convert_and_merge.py</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>os</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>sys</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>subprocess</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>pathlib</span> <span class=kn>import</span> <span class=n>Path</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>typing</span> <span class=kn>import</span> <span class=n>List</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>argparse</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>logging</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>pytesseract</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>PyPDF2</span> <span class=kn>import</span> <span class=n>PdfMerger</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>tqdm</span> <span class=kn>import</span> <span class=n>tqdm</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>setup_logging</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;
</span></span></span><span class=line><span class=cl><span class=s2>    Sets up logging to file with INFO level.
</span></span></span><span class=line><span class=cl><span class=s2>    &#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=n>logging</span><span class=o>.</span><span class=n>basicConfig</span><span class=p>(</span>
</span></span><span class=line><span class=cl>        <span class=n>filename</span><span class=o>=</span><span class=s1>&#39;convert_and_merge.log&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=n>filemode</span><span class=o>=</span><span class=s1>&#39;a&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=nb>format</span><span class=o>=</span><span class=s1>&#39;</span><span class=si>%(asctime)s</span><span class=s1> - </span><span class=si>%(levelname)s</span><span class=s1> - </span><span class=si>%(message)s</span><span class=s1>&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=n>level</span><span class=o>=</span><span class=n>logging</span><span class=o>.</span><span class=n>INFO</span>
</span></span><span class=line><span class=cl>    <span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>parse_arguments</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;
</span></span></span><span class=line><span class=cl><span class=s2>    Parses command-line arguments.
</span></span></span><span class=line><span class=cl><span class=s2>
</span></span></span><span class=line><span class=cl><span class=s2>    Returns:
</span></span></span><span class=line><span class=cl><span class=s2>        argparse.Namespace: Parsed arguments.
</span></span></span><span class=line><span class=cl><span class=s2>    &#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=n>parser</span> <span class=o>=</span> <span class=n>argparse</span><span class=o>.</span><span class=n>ArgumentParser</span><span class=p>(</span>
</span></span><span class=line><span class=cl>        <span class=n>description</span><span class=o>=</span><span class=s2>&#34;Convert images to searchable PDFs and text files using Tesseract OCR, then merge them.&#34;</span>
</span></span><span class=line><span class=cl>    <span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>parser</span><span class=o>.</span><span class=n>add_argument</span><span class=p>(</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;-i&#39;</span><span class=p>,</span> <span class=s1>&#39;--input_dir&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=nb>type</span><span class=o>=</span><span class=nb>str</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=n>help</span><span class=o>=</span><span class=s1>&#39;Directory containing input images.&#39;</span>
</span></span><span class=line><span class=cl>    <span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>parser</span><span class=o>.</span><span class=n>add_argument</span><span class=p>(</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;-o&#39;</span><span class=p>,</span> <span class=s1>&#39;--output_pdf&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=nb>type</span><span class=o>=</span><span class=nb>str</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=n>help</span><span class=o>=</span><span class=s1>&#39;Filename for the merged output PDF. Defaults to &#34;combined_document.pdf&#34;.&#39;</span>
</span></span><span class=line><span class=cl>    <span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>parser</span><span class=o>.</span><span class=n>add_argument</span><span class=p>(</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;-t&#39;</span><span class=p>,</span> <span class=s1>&#39;--output_txt&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=nb>type</span><span class=o>=</span><span class=nb>str</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=n>help</span><span class=o>=</span><span class=s1>&#39;Filename for the merged output text file. Defaults to &#34;combined_text.txt&#34;.&#39;</span>
</span></span><span class=line><span class=cl>    <span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>parser</span><span class=o>.</span><span class=n>add_argument</span><span class=p>(</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;-l&#39;</span><span class=p>,</span> <span class=s1>&#39;--languages&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=nb>type</span><span class=o>=</span><span class=nb>str</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=n>help</span><span class=o>=</span><span class=s1>&#39;Languages for OCR separated by +, e.g., &#34;eng+ind&#34;. Defaults to &#34;eng+ind&#34;.&#39;</span>
</span></span><span class=line><span class=cl>    <span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>parser</span><span class=o>.</span><span class=n>add_argument</span><span class=p>(</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;-e&#39;</span><span class=p>,</span> <span class=s1>&#39;--extension&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=nb>type</span><span class=o>=</span><span class=nb>str</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=n>help</span><span class=o>=</span><span class=s1>&#39;Image file extension to process, e.g., &#34;.jpeg&#34;, &#34;.jpg&#34;, &#34;.png&#34;. Defaults to &#34;.jpeg&#34;.&#39;</span>
</span></span><span class=line><span class=cl>    <span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>parser</span><span class=o>.</span><span class=n>add_argument</span><span class=p>(</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;-c&#39;</span><span class=p>,</span> <span class=s1>&#39;--cleanup&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=n>action</span><span class=o>=</span><span class=s1>&#39;store_true&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=n>help</span><span class=o>=</span><span class=s1>&#39;Cleanup individual PDFs and text files after merging.&#39;</span>
</span></span><span class=line><span class=cl>    <span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>parser</span><span class=o>.</span><span class=n>add_argument</span><span class=p>(</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;-r&#39;</span><span class=p>,</span> <span class=s1>&#39;--range&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=nb>type</span><span class=o>=</span><span class=nb>str</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=n>help</span><span class=o>=</span><span class=s1>&#39;Range of image numbers to process, e.g., &#34;1-58&#34;. Defaults to &#34;1-58&#34;.&#39;</span>
</span></span><span class=line><span class=cl>    <span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>parser</span><span class=o>.</span><span class=n>parse_args</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>prompt_user_inputs</span><span class=p>(</span><span class=n>args</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;
</span></span></span><span class=line><span class=cl><span class=s2>    Prompt user for inputs if they are not provided via command-line arguments.
</span></span></span><span class=line><span class=cl><span class=s2>
</span></span></span><span class=line><span class=cl><span class=s2>    Args:
</span></span></span><span class=line><span class=cl><span class=s2>        args (argparse.Namespace): Parsed arguments.
</span></span></span><span class=line><span class=cl><span class=s2>    &#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=ow>not</span> <span class=n>args</span><span class=o>.</span><span class=n>input_dir</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>args</span><span class=o>.</span><span class=n>input_dir</span> <span class=o>=</span> <span class=nb>input</span><span class=p>(</span><span class=s2>&#34;Enter the directory containing the input images (e.g., C:/Users/Username/Images): &#34;</span><span class=p>)</span><span class=o>.</span><span class=n>strip</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=ow>not</span> <span class=n>args</span><span class=o>.</span><span class=n>output_pdf</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>args</span><span class=o>.</span><span class=n>output_pdf</span> <span class=o>=</span> <span class=nb>input</span><span class=p>(</span><span class=s2>&#34;Enter the desired name for the merged output PDF (default: combined_document.pdf): &#34;</span><span class=p>)</span><span class=o>.</span><span class=n>strip</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=ow>not</span> <span class=n>args</span><span class=o>.</span><span class=n>output_pdf</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>args</span><span class=o>.</span><span class=n>output_pdf</span> <span class=o>=</span> <span class=s2>&#34;combined_document.pdf&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=ow>not</span> <span class=n>args</span><span class=o>.</span><span class=n>output_txt</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>args</span><span class=o>.</span><span class=n>output_txt</span> <span class=o>=</span> <span class=nb>input</span><span class=p>(</span><span class=s2>&#34;Enter the desired name for the merged output text file (default: combined_text.txt): &#34;</span><span class=p>)</span><span class=o>.</span><span class=n>strip</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=ow>not</span> <span class=n>args</span><span class=o>.</span><span class=n>output_txt</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>args</span><span class=o>.</span><span class=n>output_txt</span> <span class=o>=</span> <span class=s2>&#34;combined_text.txt&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=ow>not</span> <span class=n>args</span><span class=o>.</span><span class=n>languages</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>args</span><span class=o>.</span><span class=n>languages</span> <span class=o>=</span> <span class=nb>input</span><span class=p>(</span><span class=s2>&#34;Enter OCR languages separated by + (e.g., eng+ind) [default: eng+ind]: &#34;</span><span class=p>)</span><span class=o>.</span><span class=n>strip</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=ow>not</span> <span class=n>args</span><span class=o>.</span><span class=n>languages</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>args</span><span class=o>.</span><span class=n>languages</span> <span class=o>=</span> <span class=s2>&#34;eng+ind&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=ow>not</span> <span class=n>args</span><span class=o>.</span><span class=n>extension</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>args</span><span class=o>.</span><span class=n>extension</span> <span class=o>=</span> <span class=nb>input</span><span class=p>(</span><span class=s2>&#34;Enter the image file extension to process (e.g., .jpeg, .jpg, .png) [default: .jpeg]: &#34;</span><span class=p>)</span><span class=o>.</span><span class=n>strip</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=ow>not</span> <span class=n>args</span><span class=o>.</span><span class=n>extension</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>args</span><span class=o>.</span><span class=n>extension</span> <span class=o>=</span> <span class=s2>&#34;.jpeg&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=ow>not</span> <span class=n>args</span><span class=o>.</span><span class=n>range</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>args</span><span class=o>.</span><span class=n>range</span> <span class=o>=</span> <span class=nb>input</span><span class=p>(</span><span class=s2>&#34;Enter the range of image numbers to process (e.g., 1-58) [default: 1-58]: &#34;</span><span class=p>)</span><span class=o>.</span><span class=n>strip</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=ow>not</span> <span class=n>args</span><span class=o>.</span><span class=n>range</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>args</span><span class=o>.</span><span class=n>range</span> <span class=o>=</span> <span class=s2>&#34;1-58&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># Confirm cleanup option if not provided</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=ow>not</span> <span class=n>args</span><span class=o>.</span><span class=n>cleanup</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>cleanup_input</span> <span class=o>=</span> <span class=nb>input</span><span class=p>(</span><span class=s2>&#34;Do you want to cleanup individual PDFs and text files after merging? (y/n) [default: n]: &#34;</span><span class=p>)</span><span class=o>.</span><span class=n>strip</span><span class=p>()</span><span class=o>.</span><span class=n>lower</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=n>args</span><span class=o>.</span><span class=n>cleanup</span> <span class=o>=</span> <span class=n>cleanup_input</span> <span class=o>==</span> <span class=s1>&#39;y&#39;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>convert_image_to_pdf</span><span class=p>(</span><span class=n>image_path</span><span class=p>:</span> <span class=n>Path</span><span class=p>,</span> <span class=n>output_pdf_path</span><span class=p>:</span> <span class=n>Path</span><span class=p>,</span> <span class=n>languages</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=s2>&#34;eng+ind&#34;</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;
</span></span></span><span class=line><span class=cl><span class=s2>    Converts an image to a searchable PDF using Tesseract OCR.
</span></span></span><span class=line><span class=cl><span class=s2>
</span></span></span><span class=line><span class=cl><span class=s2>    Args:
</span></span></span><span class=line><span class=cl><span class=s2>        image_path (Path): Path to the input image.
</span></span></span><span class=line><span class=cl><span class=s2>        output_pdf_path (Path): Path to save the output PDF.
</span></span></span><span class=line><span class=cl><span class=s2>        languages (str, optional): Languages for Tesseract OCR. Defaults to &#34;eng+ind&#34;.
</span></span></span><span class=line><span class=cl><span class=s2>    &#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=k>try</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=ow>not</span> <span class=n>image_path</span><span class=o>.</span><span class=n>exists</span><span class=p>():</span>
</span></span><span class=line><span class=cl>            <span class=n>logging</span><span class=o>.</span><span class=n>warning</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Image file </span><span class=si>{</span><span class=n>image_path</span><span class=si>}</span><span class=s2> does not exist.&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=n>command</span> <span class=o>=</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;tesseract&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=nb>str</span><span class=p>(</span><span class=n>image_path</span><span class=p>),</span>
</span></span><span class=line><span class=cl>            <span class=nb>str</span><span class=p>(</span><span class=n>output_pdf_path</span><span class=o>.</span><span class=n>with_suffix</span><span class=p>(</span><span class=s1>&#39;&#39;</span><span class=p>)),</span>  <span class=c1># Tesseract appends .pdf</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;-l&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=n>languages</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;pdf&#39;</span>
</span></span><span class=line><span class=cl>        <span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=n>subprocess</span><span class=o>.</span><span class=n>run</span><span class=p>(</span><span class=n>command</span><span class=p>,</span> <span class=n>check</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span> <span class=n>stdout</span><span class=o>=</span><span class=n>subprocess</span><span class=o>.</span><span class=n>PIPE</span><span class=p>,</span> <span class=n>stderr</span><span class=o>=</span><span class=n>subprocess</span><span class=o>.</span><span class=n>PIPE</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>logging</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Converted </span><span class=si>{</span><span class=n>image_path</span><span class=si>}</span><span class=s2> to </span><span class=si>{</span><span class=n>output_pdf_path</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>except</span> <span class=n>subprocess</span><span class=o>.</span><span class=n>CalledProcessError</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>logging</span><span class=o>.</span><span class=n>error</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Error processing </span><span class=si>{</span><span class=n>image_path</span><span class=si>}</span><span class=s2>: </span><span class=si>{</span><span class=n>e</span><span class=o>.</span><span class=n>stderr</span><span class=o>.</span><span class=n>decode</span><span class=p>()</span><span class=o>.</span><span class=n>strip</span><span class=p>()</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>except</span> <span class=ne>Exception</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>logging</span><span class=o>.</span><span class=n>error</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Unexpected error processing </span><span class=si>{</span><span class=n>image_path</span><span class=si>}</span><span class=s2>: </span><span class=si>{</span><span class=n>e</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>extract_text_from_image</span><span class=p>(</span><span class=n>image_path</span><span class=p>:</span> <span class=n>Path</span><span class=p>,</span> <span class=n>output_txt_path</span><span class=p>:</span> <span class=n>Path</span><span class=p>,</span> <span class=n>languages</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=s2>&#34;eng+ind&#34;</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;
</span></span></span><span class=line><span class=cl><span class=s2>    Extracts text from an image using pytesseract and saves it to a text file.
</span></span></span><span class=line><span class=cl><span class=s2>
</span></span></span><span class=line><span class=cl><span class=s2>    Args:
</span></span></span><span class=line><span class=cl><span class=s2>        image_path (Path): Path to the input image.
</span></span></span><span class=line><span class=cl><span class=s2>        output_txt_path (Path): Path to save the extracted text.
</span></span></span><span class=line><span class=cl><span class=s2>        languages (str, optional): Languages for OCR. Defaults to &#34;eng+ind&#34;.
</span></span></span><span class=line><span class=cl><span class=s2>    &#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=k>try</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=ow>not</span> <span class=n>image_path</span><span class=o>.</span><span class=n>exists</span><span class=p>():</span>
</span></span><span class=line><span class=cl>            <span class=n>logging</span><span class=o>.</span><span class=n>warning</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Image file </span><span class=si>{</span><span class=n>image_path</span><span class=si>}</span><span class=s2> does not exist.&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=c1># Open the image using PIL</span>
</span></span><span class=line><span class=cl>        <span class=kn>from</span> <span class=nn>PIL</span> <span class=kn>import</span> <span class=n>Image</span>
</span></span><span class=line><span class=cl>        <span class=n>img</span> <span class=o>=</span> <span class=n>Image</span><span class=o>.</span><span class=n>open</span><span class=p>(</span><span class=n>image_path</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=c1># Use pytesseract to do OCR on the image</span>
</span></span><span class=line><span class=cl>        <span class=n>text</span> <span class=o>=</span> <span class=n>pytesseract</span><span class=o>.</span><span class=n>image_to_string</span><span class=p>(</span><span class=n>img</span><span class=p>,</span> <span class=n>lang</span><span class=o>=</span><span class=n>languages</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=c1># Write the extracted text to the txt file</span>
</span></span><span class=line><span class=cl>        <span class=k>with</span> <span class=nb>open</span><span class=p>(</span><span class=n>output_txt_path</span><span class=p>,</span> <span class=s1>&#39;w&#39;</span><span class=p>,</span> <span class=n>encoding</span><span class=o>=</span><span class=s1>&#39;utf-8&#39;</span><span class=p>)</span> <span class=k>as</span> <span class=n>f</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>f</span><span class=o>.</span><span class=n>write</span><span class=p>(</span><span class=n>text</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=n>logging</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Extracted text from </span><span class=si>{</span><span class=n>image_path</span><span class=si>}</span><span class=s2> to </span><span class=si>{</span><span class=n>output_txt_path</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>except</span> <span class=ne>Exception</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>logging</span><span class=o>.</span><span class=n>error</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Error extracting text from </span><span class=si>{</span><span class=n>image_path</span><span class=si>}</span><span class=s2>: </span><span class=si>{</span><span class=n>e</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>merge_pdfs</span><span class=p>(</span><span class=n>pdf_paths</span><span class=p>:</span> <span class=n>List</span><span class=p>[</span><span class=n>Path</span><span class=p>],</span> <span class=n>output_path</span><span class=p>:</span> <span class=n>Path</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;
</span></span></span><span class=line><span class=cl><span class=s2>    Merges multiple PDFs into a single PDF.
</span></span></span><span class=line><span class=cl><span class=s2>
</span></span></span><span class=line><span class=cl><span class=s2>    Args:
</span></span></span><span class=line><span class=cl><span class=s2>        pdf_paths (List[Path]): List of PDF file paths to merge.
</span></span></span><span class=line><span class=cl><span class=s2>        output_path (Path): Path to save the merged PDF.
</span></span></span><span class=line><span class=cl><span class=s2>    &#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=n>merger</span> <span class=o>=</span> <span class=n>PdfMerger</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>try</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=n>pdf</span> <span class=ow>in</span> <span class=n>pdf_paths</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=n>pdf</span><span class=o>.</span><span class=n>exists</span><span class=p>():</span>
</span></span><span class=line><span class=cl>                <span class=n>merger</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=nb>str</span><span class=p>(</span><span class=n>pdf</span><span class=p>))</span>
</span></span><span class=line><span class=cl>                <span class=n>logging</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Appended </span><span class=si>{</span><span class=n>pdf</span><span class=si>}</span><span class=s2> to merger.&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=n>logging</span><span class=o>.</span><span class=n>warning</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;PDF file </span><span class=si>{</span><span class=n>pdf</span><span class=si>}</span><span class=s2> does not exist and will be skipped.&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=n>merger</span><span class=o>.</span><span class=n>write</span><span class=p>(</span><span class=nb>str</span><span class=p>(</span><span class=n>output_path</span><span class=p>))</span>
</span></span><span class=line><span class=cl>        <span class=n>merger</span><span class=o>.</span><span class=n>close</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=n>logging</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Merged PDF saved as </span><span class=si>{</span><span class=n>output_path</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>except</span> <span class=ne>Exception</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>logging</span><span class=o>.</span><span class=n>error</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Error merging PDFs: </span><span class=si>{</span><span class=n>e</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>merger</span><span class=o>.</span><span class=n>close</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>merge_texts</span><span class=p>(</span><span class=n>txt_paths</span><span class=p>:</span> <span class=n>List</span><span class=p>[</span><span class=n>Path</span><span class=p>],</span> <span class=n>output_path</span><span class=p>:</span> <span class=n>Path</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;
</span></span></span><span class=line><span class=cl><span class=s2>    Merges multiple text files into a single text file.
</span></span></span><span class=line><span class=cl><span class=s2>
</span></span></span><span class=line><span class=cl><span class=s2>    Args:
</span></span></span><span class=line><span class=cl><span class=s2>        txt_paths (List[Path]): List of text file paths to merge.
</span></span></span><span class=line><span class=cl><span class=s2>        output_path (Path): Path to save the merged text file.
</span></span></span><span class=line><span class=cl><span class=s2>    &#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=k>try</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>with</span> <span class=nb>open</span><span class=p>(</span><span class=n>output_path</span><span class=p>,</span> <span class=s1>&#39;w&#39;</span><span class=p>,</span> <span class=n>encoding</span><span class=o>=</span><span class=s1>&#39;utf-8&#39;</span><span class=p>)</span> <span class=k>as</span> <span class=n>outfile</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>for</span> <span class=n>txt</span> <span class=ow>in</span> <span class=n>txt_paths</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=k>if</span> <span class=n>txt</span><span class=o>.</span><span class=n>exists</span><span class=p>():</span>
</span></span><span class=line><span class=cl>                    <span class=k>with</span> <span class=nb>open</span><span class=p>(</span><span class=n>txt</span><span class=p>,</span> <span class=s1>&#39;r&#39;</span><span class=p>,</span> <span class=n>encoding</span><span class=o>=</span><span class=s1>&#39;utf-8&#39;</span><span class=p>)</span> <span class=k>as</span> <span class=n>infile</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                        <span class=n>outfile</span><span class=o>.</span><span class=n>write</span><span class=p>(</span><span class=n>infile</span><span class=o>.</span><span class=n>read</span><span class=p>())</span>
</span></span><span class=line><span class=cl>                        <span class=n>outfile</span><span class=o>.</span><span class=n>write</span><span class=p>(</span><span class=s2>&#34;</span><span class=se>\n\n</span><span class=s2>--- End of Page ---</span><span class=se>\n\n</span><span class=s2>&#34;</span><span class=p>)</span>  <span class=c1># Separator between pages</span>
</span></span><span class=line><span class=cl>                    <span class=n>logging</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Appended </span><span class=si>{</span><span class=n>txt</span><span class=si>}</span><span class=s2> to </span><span class=si>{</span><span class=n>output_path</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                    <span class=n>logging</span><span class=o>.</span><span class=n>warning</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Text file </span><span class=si>{</span><span class=n>txt</span><span class=si>}</span><span class=s2> does not exist and will be skipped.&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>logging</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Merged text file saved as </span><span class=si>{</span><span class=n>output_path</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>except</span> <span class=ne>Exception</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>logging</span><span class=o>.</span><span class=n>error</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Error merging text files: </span><span class=si>{</span><span class=n>e</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>main</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;
</span></span></span><span class=line><span class=cl><span class=s2>    Main function to convert images to PDFs and text files, then merge them.
</span></span></span><span class=line><span class=cl><span class=s2>    &#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=n>setup_logging</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=n>args</span> <span class=o>=</span> <span class=n>parse_arguments</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># If any required arguments are missing, prompt the user</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=ow>not</span> <span class=p>(</span><span class=n>args</span><span class=o>.</span><span class=n>input_dir</span> <span class=ow>and</span> <span class=n>args</span><span class=o>.</span><span class=n>output_pdf</span> <span class=ow>and</span> <span class=n>args</span><span class=o>.</span><span class=n>output_txt</span> <span class=ow>and</span> <span class=n>args</span><span class=o>.</span><span class=n>languages</span> <span class=ow>and</span> <span class=n>args</span><span class=o>.</span><span class=n>extension</span> <span class=ow>and</span> <span class=n>args</span><span class=o>.</span><span class=n>range</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;Some required arguments are missing. You will be prompted to enter them.&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>prompt_user_inputs</span><span class=p>(</span><span class=n>args</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=c1># Even if arguments are provided, confirm cleanup preference</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=ow>not</span> <span class=n>args</span><span class=o>.</span><span class=n>cleanup</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>cleanup_input</span> <span class=o>=</span> <span class=nb>input</span><span class=p>(</span><span class=s2>&#34;Do you want to cleanup individual PDFs and text files after merging? (y/n) [default: n]: &#34;</span><span class=p>)</span><span class=o>.</span><span class=n>strip</span><span class=p>()</span><span class=o>.</span><span class=n>lower</span><span class=p>()</span>
</span></span><span class=line><span class=cl>            <span class=n>args</span><span class=o>.</span><span class=n>cleanup</span> <span class=o>=</span> <span class=n>cleanup_input</span> <span class=o>==</span> <span class=s1>&#39;y&#39;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># Validate and convert input directory to Path</span>
</span></span><span class=line><span class=cl>    <span class=n>images_dir</span> <span class=o>=</span> <span class=n>Path</span><span class=p>(</span><span class=n>args</span><span class=o>.</span><span class=n>input_dir</span><span class=p>)</span><span class=o>.</span><span class=n>expanduser</span><span class=p>()</span><span class=o>.</span><span class=n>resolve</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=ow>not</span> <span class=n>images_dir</span><span class=o>.</span><span class=n>is_dir</span><span class=p>():</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Error: The input directory &#39;</span><span class=si>{</span><span class=n>images_dir</span><span class=si>}</span><span class=s2>&#39; does not exist or is not a directory.&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>logging</span><span class=o>.</span><span class=n>error</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Invalid input directory: </span><span class=si>{</span><span class=n>images_dir</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>sys</span><span class=o>.</span><span class=n>exit</span><span class=p>(</span><span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># Define the output merged PDF and text file paths</span>
</span></span><span class=line><span class=cl>    <span class=n>merged_pdf_path</span> <span class=o>=</span> <span class=n>images_dir</span> <span class=o>/</span> <span class=n>args</span><span class=o>.</span><span class=n>output_pdf</span>
</span></span><span class=line><span class=cl>    <span class=n>merged_txt_path</span> <span class=o>=</span> <span class=n>images_dir</span> <span class=o>/</span> <span class=n>args</span><span class=o>.</span><span class=n>output_txt</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># Define languages for OCR</span>
</span></span><span class=line><span class=cl>    <span class=n>languages</span> <span class=o>=</span> <span class=n>args</span><span class=o>.</span><span class=n>languages</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># Define the range of images</span>
</span></span><span class=line><span class=cl>    <span class=k>try</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>start</span><span class=p>,</span> <span class=n>end</span> <span class=o>=</span> <span class=nb>map</span><span class=p>(</span><span class=nb>int</span><span class=p>,</span> <span class=n>args</span><span class=o>.</span><span class=n>range</span><span class=o>.</span><span class=n>split</span><span class=p>(</span><span class=s1>&#39;-&#39;</span><span class=p>))</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>start</span> <span class=o>&gt;</span> <span class=n>end</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;Error: Start of range cannot be greater than end.&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=n>logging</span><span class=o>.</span><span class=n>error</span><span class=p>(</span><span class=s2>&#34;Invalid range: start greater than end.&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=n>sys</span><span class=o>.</span><span class=n>exit</span><span class=p>(</span><span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>image_files</span> <span class=o>=</span> <span class=p>[</span><span class=n>images_dir</span> <span class=o>/</span> <span class=sa>f</span><span class=s2>&#34;</span><span class=si>{</span><span class=n>i</span><span class=si>}{</span><span class=n>args</span><span class=o>.</span><span class=n>extension</span><span class=si>}</span><span class=s2>&#34;</span> <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=n>start</span><span class=p>,</span> <span class=n>end</span> <span class=o>+</span> <span class=mi>1</span><span class=p>)]</span>
</span></span><span class=line><span class=cl>    <span class=k>except</span> <span class=ne>ValueError</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;Error: Invalid range format. Use start-end, e.g., 1-58.&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>logging</span><span class=o>.</span><span class=n>error</span><span class=p>(</span><span class=s2>&#34;Invalid range format provided.&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>sys</span><span class=o>.</span><span class=n>exit</span><span class=p>(</span><span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># Define lists to store individual PDF and text paths</span>
</span></span><span class=line><span class=cl>    <span class=n>individual_pdfs</span> <span class=o>=</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl>    <span class=n>individual_txts</span> <span class=o>=</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;</span><span class=se>\n</span><span class=s2>Starting conversion of images to PDFs and text files...&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>logging</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=s2>&#34;Starting conversion of images to PDFs and text files.&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>image_path</span> <span class=ow>in</span> <span class=n>tqdm</span><span class=p>(</span><span class=n>image_files</span><span class=p>,</span> <span class=n>desc</span><span class=o>=</span><span class=s2>&#34;Processing Images&#34;</span><span class=p>,</span> <span class=n>unit</span><span class=o>=</span><span class=s2>&#34;image&#34;</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=c1># Define output paths</span>
</span></span><span class=line><span class=cl>        <span class=n>output_pdf</span> <span class=o>=</span> <span class=n>image_path</span><span class=o>.</span><span class=n>with_suffix</span><span class=p>(</span><span class=s1>&#39;.pdf&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>output_txt</span> <span class=o>=</span> <span class=n>image_path</span><span class=o>.</span><span class=n>with_suffix</span><span class=p>(</span><span class=s1>&#39;.txt&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=c1># Convert image to PDF</span>
</span></span><span class=line><span class=cl>        <span class=n>convert_image_to_pdf</span><span class=p>(</span><span class=n>image_path</span><span class=p>,</span> <span class=n>output_pdf</span><span class=p>,</span> <span class=n>languages</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>output_pdf</span><span class=o>.</span><span class=n>exists</span><span class=p>():</span>
</span></span><span class=line><span class=cl>            <span class=n>individual_pdfs</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>output_pdf</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>logging</span><span class=o>.</span><span class=n>warning</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Failed to create PDF for </span><span class=si>{</span><span class=n>image_path</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=c1># Extract text from image to txt</span>
</span></span><span class=line><span class=cl>        <span class=n>extract_text_from_image</span><span class=p>(</span><span class=n>image_path</span><span class=p>,</span> <span class=n>output_txt</span><span class=p>,</span> <span class=n>languages</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>output_txt</span><span class=o>.</span><span class=n>exists</span><span class=p>():</span>
</span></span><span class=line><span class=cl>            <span class=n>individual_txts</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>output_txt</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>logging</span><span class=o>.</span><span class=n>warning</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Failed to create text file for </span><span class=si>{</span><span class=n>image_path</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;</span><span class=se>\n</span><span class=s2>Conversion complete.</span><span class=se>\n</span><span class=s2>Starting merging of PDFs and text files...&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>logging</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=s2>&#34;Conversion complete. Starting merging of PDFs and text files.&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># Sort PDFs and text files based on numerical order</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>extract_number</span><span class=p>(</span><span class=n>file</span><span class=p>:</span> <span class=n>Path</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>int</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>try</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=nb>int</span><span class=p>(</span><span class=n>file</span><span class=o>.</span><span class=n>stem</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>except</span> <span class=ne>ValueError</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>logging</span><span class=o>.</span><span class=n>warning</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Non-numeric filename: </span><span class=si>{</span><span class=n>file</span><span class=o>.</span><span class=n>name</span><span class=si>}</span><span class=s2>. Assigning sorting key 0.&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=mi>0</span>  <span class=c1># Assign 0 or handle differently</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>individual_pdfs_sorted</span> <span class=o>=</span> <span class=nb>sorted</span><span class=p>(</span><span class=n>individual_pdfs</span><span class=p>,</span> <span class=n>key</span><span class=o>=</span><span class=n>extract_number</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>individual_txts_sorted</span> <span class=o>=</span> <span class=nb>sorted</span><span class=p>(</span><span class=n>individual_txts</span><span class=p>,</span> <span class=n>key</span><span class=o>=</span><span class=n>extract_number</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># Merge PDFs</span>
</span></span><span class=line><span class=cl>    <span class=n>merge_pdfs</span><span class=p>(</span><span class=n>individual_pdfs_sorted</span><span class=p>,</span> <span class=n>merged_pdf_path</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># Merge Text Files</span>
</span></span><span class=line><span class=cl>    <span class=n>merge_texts</span><span class=p>(</span><span class=n>individual_txts_sorted</span><span class=p>,</span> <span class=n>merged_txt_path</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;</span><span class=se>\n</span><span class=s2>Merged PDF saved as </span><span class=si>{</span><span class=n>merged_pdf_path</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Merged text file saved as </span><span class=si>{</span><span class=n>merged_txt_path</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>logging</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Merged PDF saved as </span><span class=si>{</span><span class=n>merged_pdf_path</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>logging</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Merged text file saved as </span><span class=si>{</span><span class=n>merged_txt_path</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>args</span><span class=o>.</span><span class=n>cleanup</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;</span><span class=se>\n</span><span class=s2>Cleaning up individual PDF and text files...&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>logging</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=s2>&#34;Starting cleanup of individual PDF and text files.&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=n>pdf</span> <span class=ow>in</span> <span class=n>individual_pdfs_sorted</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>try</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=n>pdf</span><span class=o>.</span><span class=n>unlink</span><span class=p>()</span>
</span></span><span class=line><span class=cl>                <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Deleted </span><span class=si>{</span><span class=n>pdf</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                <span class=n>logging</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Deleted </span><span class=si>{</span><span class=n>pdf</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=k>except</span> <span class=ne>Exception</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Error deleting </span><span class=si>{</span><span class=n>pdf</span><span class=si>}</span><span class=s2>: </span><span class=si>{</span><span class=n>e</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                <span class=n>logging</span><span class=o>.</span><span class=n>error</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Error deleting </span><span class=si>{</span><span class=n>pdf</span><span class=si>}</span><span class=s2>: </span><span class=si>{</span><span class=n>e</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=n>txt</span> <span class=ow>in</span> <span class=n>individual_txts_sorted</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>try</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=n>txt</span><span class=o>.</span><span class=n>unlink</span><span class=p>()</span>
</span></span><span class=line><span class=cl>                <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Deleted </span><span class=si>{</span><span class=n>txt</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                <span class=n>logging</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Deleted </span><span class=si>{</span><span class=n>txt</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=k>except</span> <span class=ne>Exception</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Error deleting </span><span class=si>{</span><span class=n>txt</span><span class=si>}</span><span class=s2>: </span><span class=si>{</span><span class=n>e</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                <span class=n>logging</span><span class=o>.</span><span class=n>error</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Error deleting </span><span class=si>{</span><span class=n>txt</span><span class=si>}</span><span class=s2>: </span><span class=si>{</span><span class=n>e</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;</span><span class=se>\n</span><span class=s2>Process completed successfully!&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>logging</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=s2>&#34;Process completed successfully.&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=vm>__name__</span> <span class=o>==</span> <span class=s2>&#34;__main__&#34;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>main</span><span class=p>()</span>
</span></span></code></pre></div><hr><h2 id=3-detailed-explanation-of-enhancements><strong>3. Detailed Explanation of Enhancements</strong><a hidden class=anchor aria-hidden=true href=#3-detailed-explanation-of-enhancements>#</a></h2><h3 id=31-dual-conversion-pdf-and-text-files><strong>3.1. Dual Conversion: PDF and Text Files</strong><a hidden class=anchor aria-hidden=true href=#31-dual-conversion-pdf-and-text-files>#</a></h3><p>To meet your requirement of generating both searchable PDFs and accompanying text files, two key functions have been added:</p><ol><li><p><strong><code>convert_image_to_pdf</code>:</strong></p><ul><li>Utilizes Tesseract via a subprocess call to convert each image into a searchable PDF.</li><li>Ensures that the OCR layer is embedded within the PDF for text selection.</li></ul></li><li><p><strong><code>extract_text_from_image</code>:</strong></p><ul><li>Uses <code>pytesseract</code> to extract raw text from each image.</li><li>Saves the extracted text to a <code>.txt</code> file.</li><li>This provides a separate text file that can be referenced or used independently of the PDF.</li></ul></li></ol><h3 id=32-merging-functionality-expanded><strong>3.2. Merging Functionality Expanded</strong><a hidden class=anchor aria-hidden=true href=#32-merging-functionality-expanded>#</a></h3><p>In addition to merging individual PDFs into a single PDF, the script also merges individual text files into a single comprehensive text document:</p><ol><li><p><strong><code>merge_pdfs</code>:</strong></p><ul><li>Remains largely the same, appending each individual PDF in numerical order to ensure the final merged PDF maintains the correct sequence.</li></ul></li><li><p><strong><code>merge_texts</code>:</strong></p><ul><li>Introduced to concatenate all individual text files into one.</li><li>Inserts a clear separator (<code>--- End of Page ---</code>) between each page&rsquo;s content for better readability.</li></ul></li></ol><h3 id=33-interactive-prompts-for-enhanced-user-friendliness><strong>3.3. Interactive Prompts for Enhanced User-Friendliness</strong><a hidden class=anchor aria-hidden=true href=#33-interactive-prompts-for-enhanced-user-friendliness>#</a></h3><p>The script now intelligently prompts users for any missing information instead of relying solely on command-line arguments. This ensures that even users unfamiliar with command-line operations can effectively use the tool.</p><h3 id=34-logging-for-better-monitoring-and-debugging><strong>3.4. Logging for Better Monitoring and Debugging</strong><a hidden class=anchor aria-hidden=true href=#34-logging-for-better-monitoring-and-debugging>#</a></h3><p>Comprehensive logging has been integrated:</p><ul><li><strong>Log File:</strong> All operations, successes, warnings, and errors are logged to <code>convert_and_merge.log</code>.</li><li><strong>Console Feedback:</strong> Users receive real-time feedback on the conversion and merging processes.</li></ul><h3 id=35-cleanup-functionality><strong>3.5. Cleanup Functionality</strong><a hidden class=anchor aria-hidden=true href=#35-cleanup-functionality>#</a></h3><p>An optional cleanup feature allows users to delete individual PDFs and text files after successfully merging them, reducing clutter and saving disk space.</p></div><footer class=post-footer><ul class=post-tags><li><a href=http://labrat-vm:1313/tags/kuliah/>Kuliah</a></li></ul><nav class=paginav><a class=prev href=http://labrat-vm:1313/posts/modul-downloader/><span class=title>« Prev</span><br><span>Universitas Terbuka Modul Downloader Into Image</span>
</a><a class=next href=http://labrat-vm:1313/posts/reverse-pdf/><span class=title>Next »</span><br><span>Reverse PDF Universitas Terbuka Modul</span></a></nav></footer></article></main><footer class=footer><span>&copy; 2025 <a href=http://labrat-vm:1313/>Labrat</a></span> ·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script></body></html>