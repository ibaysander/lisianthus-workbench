<!doctype html><html lang=en dir=auto><head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Reverse PDF Universitas Terbuka Modul | Labrat</title>
<meta name=keywords content="first"><meta name=description content="Desc Text."><meta name=author content="lisianthus"><link rel=canonical href=https://canonical.url/to/page><link crossorigin=anonymous href=/assets/css/stylesheet.45e028aa8ce0961349adf411b013ee39406be2c0bc80d4ea3fc04555f7f4611a.css integrity="sha256-ReAoqozglhNJrfQRsBPuOUBr4sC8gNTqP8BFVff0YRo=" rel="preload stylesheet" as=style><link rel=icon href=http://labrat-vm:1313/%3Clink%20/%20abs%20url%3E><link rel=icon type=image/png sizes=16x16 href=http://labrat-vm:1313/%3Clink%20/%20abs%20url%3E><link rel=icon type=image/png sizes=32x32 href=http://labrat-vm:1313/%3Clink%20/%20abs%20url%3E><link rel=apple-touch-icon href=http://labrat-vm:1313/%3Clink%20/%20abs%20url%3E><link rel=mask-icon href=http://labrat-vm:1313/%3Clink%20/%20abs%20url%3E><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=http://labrat-vm:1313/posts/my-first-post/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><meta property="og:url" content="http://labrat-vm:1313/posts/my-first-post/"><meta property="og:site_name" content="Labrat"><meta property="og:title" content="Reverse PDF Universitas Terbuka Modul"><meta property="og:description" content="Desc Text."><meta property="og:locale" content="en"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2025-02-04T07:39:28+00:00"><meta property="article:modified_time" content="2025-02-04T07:39:28+00:00"><meta property="article:tag" content="First"><meta property="og:image" content="http://labrat-vm:1313/%3Cimage%20path/url%3E"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="http://labrat-vm:1313/%3Cimage%20path/url%3E"><meta name=twitter:title content="Reverse PDF Universitas Terbuka Modul"><meta name=twitter:description content="Desc Text."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"http://labrat-vm:1313/posts/"},{"@type":"ListItem","position":2,"name":"Reverse PDF Universitas Terbuka Modul","item":"http://labrat-vm:1313/posts/my-first-post/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Reverse PDF Universitas Terbuka Modul","name":"Reverse PDF Universitas Terbuka Modul","description":"Desc Text.","keywords":["first"],"articleBody":"Below, I’ll guide you through the entire process step-by-step, covering:\nSetting Up Your Environment Installing Required Software and Python Packages Understanding the Workflow Writing the Python Script Enhancements and Best Practices Testing and Troubleshooting Let’s get started!\n1. Setting Up Your Environment Before diving into coding, ensure that your development environment is correctly set up.\n1.1. Install Python If you haven’t installed Python yet:\nDownload Python:\nVisit the official Python website and download the latest stable release. It’s recommended to install Python 3.7 or higher. During Installation:\nWindows: Ensure you check the box “Add Python to PATH”. This makes it easier to run Python and pip from the command line. Follow the prompts to complete the installation. Verify Installation:\nOpen Command Prompt or PowerShell and run:\npython --version You should see something like:\nPython 3.11.4 1.2. Install an Integrated Development Environment (IDE) While not mandatory, an IDE can significantly enhance your productivity. Here are some popular choices:\nVisual Studio Code: Lightweight and highly customizable. PyCharm: Feature-rich, especially for larger projects. Atom: Simple and hackable text editor. For this guide, we’ll assume you’re using Visual Studio Code (VS Code).\n2. Installing Required Software and Python Packages 2.1. Install Tesseract OCR Tesseract is essential for OCR operations.\nDownload Tesseract:\nVisit the Tesseract OCR GitHub repository. For Windows users, you can directly download the installer from UB Mannheim’s Tesseract builds. Installation Steps (Windows):\nRun the installer. During installation, note the installation path (e.g., C:\\Program Files\\Tesseract-OCR\\). Ensure that the installer adds Tesseract to your system’s PATH. If not, you’ll need to add it manually: Manually Adding to PATH: Right-click on This PC \u003e Properties \u003e Advanced system settings. Click on Environment Variables. Under System variables, find and select Path, then click Edit. Click New and add the path to your Tesseract installation (e.g., C:\\Program Files\\Tesseract-OCR\\). Click OK to save. Verify Installation:\nOpen Command Prompt or PowerShell and run:\ntesseract --version You should see version information, e.g.:\ntesseract v5.3.0 2.2. Install Language Data Files Since you need support for English (eng) and Indonesian (ind):\nDownload Language Data:\nThe language data files (trained data) are usually included by default. However, to ensure you have both English and Indonesian, you can download them from Tesseract’s tessdata repository. Place Language Files:\nCopy eng.traineddata and ind.traineddata to Tesseract’s tessdata directory (e.g., C:\\Program Files\\Tesseract-OCR\\tessdata\\). 2.3. Set Up a Python Virtual Environment (Optional but Recommended) Using a virtual environment isolates your project’s dependencies.\nNavigate to Your Project Directory:\nmkdir C:\\Users\\marve\\Downloads\\Modul1 cd C:\\Users\\marve\\Downloads\\Modul1 Create a Virtual Environment:\npython -m venv venv Activate the Virtual Environment:\nWindows:\n.\\venv\\Scripts\\activate PowerShell:\n.\\venv\\Scripts\\Activate.ps1 Unix or MacOS:\nsource venv/bin/activate Verify Activation:\nYour prompt should change to indicate that the virtual environment is active, e.g., (venv) C:\\Users\\marve\\Downloads\\Modul1\u003e\n2.4. Install Required Python Packages We’ll need several Python libraries:\npytesseract: Python wrapper for Tesseract OCR. Pillow: For image processing. PyPDF2 or pdfmerge: For merging PDFs. tqdm: For progress bars (optional but useful). Install via pip:\npip install pytesseract Pillow PyPDF2 tqdm Note: PyPDF2 is a popular library for PDF manipulation. Alternatively, you can use pdfrw, pdfminer, or others based on specific needs.\n3. Understanding the Workflow Before writing code, it’s crucial to understand the steps involved:\nLocate Image Files:\nIdentify all images (e.g., 1.jpeg to 58.jpeg) within a specified directory. Convert Images to Searchable PDFs:\nFor each image: Use Tesseract to perform OCR, specifying appropriate languages. Save the output as an individual PDF. Merge Individual PDFs into a Single PDF:\nCombine all individual PDFs into one comprehensive PDF, maintaining the correct order. Cleanup (Optional):\nRemove individual PDFs if only the merged PDF is needed. 4. Writing the Python Script We’ll create a Python script named convert_and_merge.py that accomplishes the tasks mentioned above.\n4.1. Script Structure We’ll structure the script into functions for better readability and maintenance:\nconvert_image_to_pdf(image_path, output_pdf_path, languages): Converts a single image to a searchable PDF. merge_pdfs(pdf_paths, output_path): Merges a list of PDFs into a single PDF. main(): Orchestrates the entire process. 4.2. Writing the Script Create a new file named convert_and_merge.py in your project directory and open it in your IDE.\n# convert_and_merge.py import os import sys import subprocess from pathlib import Path from typing import List import pytesseract from PIL import Image from PyPDF2 import PdfMerger from tqdm import tqdm def convert_image_to_pdf(image_path: Path, output_pdf_path: Path, languages: str = \"eng+ind\"): \"\"\" Converts an image to a searchable PDF using Tesseract OCR. Args: image_path (Path): Path to the input image. output_pdf_path (Path): Path to save the output PDF. languages (str, optional): Languages for Tesseract OCR. Defaults to \"eng+ind\". \"\"\" try: # Ensure the image exists if not image_path.exists(): print(f\"Image file {image_path} does not exist.\") return # Construct the Tesseract command # tesseract input_image output_base -l lang --dpi 300 pdf # We use '--dpi 300' to specify resolution; adjust as needed # The output_pdf_path should not have the .pdf extension in the second parameter command = [ 'tesseract', str(image_path), str(output_pdf_path.with_suffix('')), # Tesseract appends .pdf '-l', languages, 'pdf' ] # Run the Tesseract command subprocess.run(command, check=True, stdout=subprocess.PIPE, stderr=subprocess.PIPE) except subprocess.CalledProcessError as e: print(f\"Error processing {image_path}: {e}\") except Exception as e: print(f\"Unexpected error processing {image_path}: {e}\") def merge_pdfs(pdf_paths: List[Path], output_path: Path): \"\"\" Merges multiple PDFs into a single PDF. Args: pdf_paths (List[Path]): List of PDF file paths to merge. output_path (Path): Path to save the merged PDF. \"\"\" merger = PdfMerger() try: for pdf in pdf_paths: if pdf.exists(): merger.append(str(pdf)) else: print(f\"PDF file {pdf} does not exist and will be skipped.\") # Write out the merged PDF merger.write(str(output_path)) merger.close() except Exception as e: print(f\"Error merging PDFs: {e}\") merger.close() def main(): \"\"\" Main function to convert images to PDFs and merge them. \"\"\" # Define the directory containing images images_dir = Path(\"C:/Users/marve/Downloads/Modul1\") # Adjust as needed # Define the output merged PDF path merged_pdf_path = images_dir / \"combined_document.pdf\" # Define languages for OCR languages = \"eng+ind\" # Define the range of images or pattern # Here, assuming images are named as 1.jpeg to 58.jpeg image_files = [images_dir / f\"{i}.jpeg\" for i in range(1, 59)] # Define a list to store individual PDF paths individual_pdfs = [] print(\"Starting conversion of images to PDFs...\") for image_path in tqdm(image_files, desc=\"Converting Images\", unit=\"image\"): output_pdf = image_path.with_suffix('.pdf') convert_image_to_pdf(image_path, output_pdf, languages) if output_pdf.exists(): individual_pdfs.append(output_pdf) print(\"Converting complete.\\nStarting merging of PDFs...\") # Sort PDFs based on numerical order individual_pdfs_sorted = sorted(individual_pdfs, key=lambda x: int(x.stem)) # Merge PDFs merge_pdfs(individual_pdfs_sorted, merged_pdf_path) print(f\"Merged PDF saved as {merged_pdf_path}\") print(\"\\nOptional: Cleaning up individual PDF files.\") # Uncomment the following lines if you want to delete individual PDFs after merging # for pdf in individual_pdfs_sorted: # try: # pdf.unlink() # print(f\"Deleted {pdf}\") # except Exception as e: # print(f\"Error deleting {pdf}: {e}\") print(\"Process completed successfully!\") if __name__ == \"__main__\": main() 4.3. Script Explanation Imports:\nos, sys, subprocess: For interacting with the system and running external commands. Path from pathlib: For convenient path manipulations. List from typing: For type hinting. pytesseract, PIL.Image: For image processing and OCR (though in this script, pytesseract isn’t directly used; Tesseract is called via subprocess). PyPDF2.PdfMerger: To merge PDFs. tqdm: For displaying progress bars. convert_image_to_pdf Function:\nConstructs and runs the Tesseract command to convert an image to a searchable PDF. Checks if the input image exists. Handles exceptions and provides feedback on errors. merge_pdfs Function:\nUses PyPDF2.PdfMerger to append each PDF in the correct order. Skips any missing PDFs and informs the user. Writes the merged PDF to the specified output_path. main Function:\nDefines the directory containing images and the output path for the merged PDF. Specifies the OCR languages (eng+ind for English and Indonesian). Generates a list of image file paths (1.jpeg to 58.jpeg). Iterates through each image, converting them to PDFs while displaying a progress bar. Sorts the individual PDFs numerically to maintain order. Merges all PDFs into a single document. Optionally, cleans up individual PDF files after merging (currently commented out). Execution:\nThe script runs the main() function when executed directly. 4.4. Important Considerations Tesseract’s Output Handling:\nTesseract appends the .pdf extension automatically. Therefore, when specifying the output base name, you should omit the .pdf suffix in the second argument. Error Handling:\nThe script includes basic error handling. Depending on your use case, you might want to enhance this (e.g., logging errors to a file). Progress Feedback:\nThe tqdm library provides a neat progress bar during the conversion process, enhancing user experience. Cleanup Process:\nAfter merging, you might not need individual PDF files. The script includes an optional cleanup section that you can enable by uncommenting the relevant lines. 5. Enhancements and Best Practices To make your application more robust and user-friendly, consider implementing the following enhancements:\n5.1. Command-Line Arguments Allow users to specify parameters like input directory, output file name, language options, etc.\nImplementation:\nUse the argparse module to parse command-line arguments.\nimport argparse def parse_arguments(): parser = argparse.ArgumentParser(description=\"Convert images to searchable PDF and merge them.\") parser.add_argument( '-i', '--input_dir', type=str, default=\"C:/Users/marve/Downloads/Modul1\", help='Directory containing input images.' ) parser.add_argument( '-o', '--output_pdf', type=str, default=None, help='Filename for the merged output PDF. Defaults to \"combined_document.pdf\".' ) parser.add_argument( '-l', '--languages', type=str, default=\"eng+ind\", help='Languages for OCR separated by +, e.g., \"eng+ind\".' ) parser.add_argument( '-e', '--extension', type=str, default=\".jpeg\", help='Image file extension to process, e.g., \".jpeg\", \".jpg\", \".png\".' ) parser.add_argument( '-c', '--cleanup', action='store_true', help='Cleanup individual PDFs after merging.' ) parser.add_argument( '-r', '--range', type=str, default=\"1-58\", help='Range of image numbers to process, e.g., \"1-58\".' ) return parser.parse_args() Integrate into main():\ndef main(): args = parse_arguments() # Define the directory containing images images_dir = Path(args.input_dir) # Define the output merged PDF path if args.output_pdf: merged_pdf_path = images_dir / args.output_pdf else: merged_pdf_path = images_dir / \"combined_document.pdf\" # Define languages for OCR languages = args.languages # Define the range of images try: start, end = map(int, args.range.split('-')) image_files = [images_dir / f\"{i}{args.extension}\" for i in range(start, end + 1)] except ValueError: print(\"Invalid range format. Use start-end, e.g., 1-58.\") sys.exit(1) # Define a list to store individual PDF paths individual_pdfs = [] print(\"Starting conversion of images to PDFs...\") for image_path in tqdm(image_files, desc=\"Converting Images\", unit=\"image\"): output_pdf = image_path.with_suffix('.pdf') convert_image_to_pdf(image_path, output_pdf, languages) if output_pdf.exists(): individual_pdfs.append(output_pdf) print(\"Converting complete.\\nStarting merging of PDFs...\") # Sort PDFs based on numerical order def extract_number(pdf: Path) -\u003e int: try: return int(pdf.stem) except ValueError: return 0 # Or handle differently individual_pdfs_sorted = sorted(individual_pdfs, key=extract_number) # Merge PDFs merge_pdfs(individual_pdfs_sorted, merged_pdf_path) print(f\"Merged PDF saved as {merged_pdf_path}\") if args.cleanup: print(\"\\nCleaning up individual PDF files.\") for pdf in individual_pdfs_sorted: try: pdf.unlink() print(f\"Deleted {pdf}\") except Exception as e: print(f\"Error deleting {pdf}: {e}\") print(\"Process completed successfully!\") Benefits:\nEnhanced flexibility. Users can specify custom parameters without modifying the script. 5.2. Logging Implement logging to record the process details, especially useful for debugging.\nImplementation:\nimport logging def setup_logging(): logging.basicConfig( filename='convert_and_merge.log', filemode='a', format='%(asctime)s - %(levelname)s - %(message)s', level=logging.INFO ) # Update functions to use logging def convert_image_to_pdf(image_path: Path, output_pdf_path: Path, languages: str = \"eng+ind\"): try: if not image_path.exists(): logging.warning(f\"Image file {image_path} does not exist.\") return command = [ 'tesseract', str(image_path), str(output_pdf_path.with_suffix('')), '-l', languages, 'pdf' ] subprocess.run(command, check=True, stdout=subprocess.PIPE, stderr=subprocess.PIPE) logging.info(f\"Converted {image_path} to {output_pdf_path}\") except subprocess.CalledProcessError as e: logging.error(f\"Error processing {image_path}: {e}\") except Exception as e: logging.error(f\"Unexpected error processing {image_path}: {e}\") def merge_pdfs(pdf_paths: List[Path], output_path: Path): merger = PdfMerger() try: for pdf in pdf_paths: if pdf.exists(): merger.append(str(pdf)) logging.info(f\"Appended {pdf} to merger.\") else: logging.warning(f\"PDF file {pdf} does not exist and will be skipped.\") merger.write(str(output_path)) merger.close() logging.info(f\"Merged PDF saved as {output_path}\") except Exception as e: logging.error(f\"Error merging PDFs: {e}\") merger.close() Benefits:\nPersistent records of the application’s operations. Easier identification and troubleshooting of issues. 5.3. GUI Implementation (Optional) For users who prefer a graphical interface, you can enhance the application using libraries like tkinter, PyQt, or Kivy.\nGiven the scope, we’ll skip GUI implementation in this guide, but feel free to explore it based on your needs.\n6. Testing and Troubleshooting 6.1. Running the Script Ensure Virtual Environment is Activated (if using one):\n.\\venv\\Scripts\\activate Navigate to Script Directory:\ncd C:\\Users\\marve\\Downloads\\Modul1 Run the Script:\npython convert_and_merge.py Or, if you’ve implemented command-line arguments:\npython convert_and_merge.py -i \"C:/Users/marve/Downloads/Modul1\" -o \"combined_document.pdf\" -l \"eng+ind\" -e \".jpeg\" -c -r \"1-58\" 6.2. Common Issues and Solutions tesseract Not Recognized:\nIssue: The system can’t find the tesseract command. Solution: Ensure Tesseract is installed and added to the system’s PATH. Verify by running tesseract --version in the command line. Incorrect Image Paths:\nIssue: The script can’t find image files. Solution: Ensure that image files are named correctly and placed in the specified directory. Verify the file extensions. Language Data Not Found:\nIssue: Tesseract reports missing language data for specified languages. Solution: Confirm that the necessary .traineddata files (e.g., eng.traineddata, ind.traineddata) are present in Tesseract’s tessdata directory. Permission Errors:\nIssue: The script lacks permissions to read/write files. Solution: Run the script with appropriate permissions. On Windows, ensure that your user account has read/write access to the target directory. Large Files or Memory Issues:\nIssue: Processing large images or numerous files may consume significant memory. Solution: Optimize images before processing (e.g., reduce resolution/resizing if possible). Monitor system resources during execution. 6.3. Verifying Output Individual PDFs:\nOpen a few converted PDFs (e.g., 1.pdf, 2.pdf) to ensure that: The PDF displays the image correctly. The text is selectable/searchable, indicating successful OCR. Merged PDF:\nOpen combined_document.pdf and navigate through the pages to confirm that: All pages are included in the correct order. The searchable text layer functions as expected. 7. Final Thoughts and Best Practices Backup Your Data:\nBefore running bulk operations, especially those that modify or delete files, ensure you have backups. Handle Different Image Formats:\nExtend the script to handle multiple image formats (.jpg, .png, etc.) by adjusting the extension parameter or using pattern matching. Optimize OCR Settings:\nDepending on your images, you might need to adjust DPI settings or perform pre-processing (e.g., grayscale conversion, noise reduction) to improve OCR accuracy. Error Logging:\nContinuous logging helps in monitoring the application’s performance and diagnosing issues. Scalability:\nFor processing a large number of images or large-sized files, consider implementing multithreading or multiprocessing to speed up the process. User Feedback:\nIncorporate more detailed feedback, such as estimated time remaining or summaries of processed files. Packaging:\nFor distribution, consider packaging the script using tools like PyInstaller to create an executable. Complete Enhanced Script with Command-Line Arguments and Logging Here’s the enhanced version of convert_and_merge.py incorporating command-line arguments and logging:\n# convert_and_merge.py import os import sys import subprocess from pathlib import Path from typing import List import argparse import logging import pytesseract from PIL import Image from PyPDF2 import PdfMerger from tqdm import tqdm def setup_logging(): logging.basicConfig( filename='convert_and_merge.log', filemode='a', format='%(asctime)s - %(levelname)s - %(message)s', level=logging.INFO ) def parse_arguments(): parser = argparse.ArgumentParser(description=\"Convert images to searchable PDF and merge them.\") parser.add_argument( '-i', '--input_dir', type=str, default=\"C:/Users/marve/Downloads/Modul1\", help='Directory containing input images.' ) parser.add_argument( '-o', '--output_pdf', type=str, default=None, help='Filename for the merged output PDF. Defaults to \"combined_document.pdf\".' ) parser.add_argument( '-l', '--languages', type=str, default=\"eng+ind\", help='Languages for OCR separated by +, e.g., \"eng+ind\".' ) parser.add_argument( '-e', '--extension', type=str, default=\".jpeg\", help='Image file extension to process, e.g., \".jpeg\", \".jpg\", \".png\".' ) parser.add_argument( '-c', '--cleanup', action='store_true', help='Cleanup individual PDFs after merging.' ) parser.add_argument( '-r', '--range', type=str, default=\"1-58\", help='Range of image numbers to process, e.g., \"1-58\".' ) return parser.parse_args() def convert_image_to_pdf(image_path: Path, output_pdf_path: Path, languages: str = \"eng+ind\"): \"\"\" Converts an image to a searchable PDF using Tesseract OCR. Args: image_path (Path): Path to the input image. output_pdf_path (Path): Path to save the output PDF. languages (str, optional): Languages for Tesseract OCR. Defaults to \"eng+ind\". \"\"\" try: if not image_path.exists(): logging.warning(f\"Image file {image_path} does not exist.\") return command = [ 'tesseract', str(image_path), str(output_pdf_path.with_suffix('')), # Tesseract appends .pdf '-l', languages, 'pdf' ] subprocess.run(command, check=True, stdout=subprocess.PIPE, stderr=subprocess.PIPE) logging.info(f\"Converted {image_path} to {output_pdf_path}\") except subprocess.CalledProcessError as e: logging.error(f\"Error processing {image_path}: {e.stderr.decode().strip()}\") except Exception as e: logging.error(f\"Unexpected error processing {image_path}: {e}\") def merge_pdfs(pdf_paths: List[Path], output_path: Path): \"\"\" Merges multiple PDFs into a single PDF. Args: pdf_paths (List[Path]): List of PDF file paths to merge. output_path (Path): Path to save the merged PDF. \"\"\" merger = PdfMerger() try: for pdf in pdf_paths: if pdf.exists(): merger.append(str(pdf)) logging.info(f\"Appended {pdf} to merger.\") else: logging.warning(f\"PDF file {pdf} does not exist and will be skipped.\") merger.write(str(output_path)) merger.close() logging.info(f\"Merged PDF saved as {output_path}\") except Exception as e: logging.error(f\"Error merging PDFs: {e}\") merger.close() def main(): \"\"\" Main function to convert images to PDFs and merge them. \"\"\" setup_logging() args = parse_arguments() # Define the directory containing images images_dir = Path(args.input_dir) # Define the output merged PDF path if args.output_pdf: merged_pdf_path = images_dir / args.output_pdf else: merged_pdf_path = images_dir / \"combined_document.pdf\" # Define languages for OCR languages = args.languages # Define the range of images try: start, end = map(int, args.range.split('-')) image_files = [images_dir / f\"{i}{args.extension}\" for i in range(start, end + 1)] except ValueError: print(\"Invalid range format. Use start-end, e.g., 1-58.\") logging.error(\"Invalid range format provided.\") sys.exit(1) # Define a list to store individual PDF paths individual_pdfs = [] print(\"Starting conversion of images to PDFs...\") logging.info(\"Starting conversion of images to PDFs.\") for image_path in tqdm(image_files, desc=\"Converting Images\", unit=\"image\"): output_pdf = image_path.with_suffix('.pdf') convert_image_to_pdf(image_path, output_pdf, languages) if output_pdf.exists(): individual_pdfs.append(output_pdf) print(\"Converting complete.\\nStarting merging of PDFs...\") logging.info(\"Conversion complete. Starting merging of PDFs.\") # Sort PDFs based on numerical order def extract_number(pdf: Path) -\u003e int: try: return int(pdf.stem) except ValueError: logging.warning(f\"Non-numeric PDF filename: {pdf.name}. Assigning sorting key 0.\") return 0 # Or handle differently individual_pdfs_sorted = sorted(individual_pdfs, key=extract_number) # Merge PDFs merge_pdfs(individual_pdfs_sorted, merged_pdf_path) print(f\"Merged PDF saved as {merged_pdf_path}\") logging.info(f\"Merged PDF saved as {merged_pdf_path}\") if args.cleanup: print(\"\\nCleaning up individual PDF files.\") logging.info(\"Starting cleanup of individual PDF files.\") for pdf in individual_pdfs_sorted: try: pdf.unlink() print(f\"Deleted {pdf}\") logging.info(f\"Deleted {pdf}\") except Exception as e: print(f\"Error deleting {pdf}: {e}\") logging.error(f\"Error deleting {pdf}: {e}\") print(\"Process completed successfully!\") logging.info(\"Process completed successfully.\") if __name__ == \"__main__\": main() 7.1. Running the Enhanced Script Command-Line Usage:\npython convert_and_merge.py -i \"C:/Users/marve/Downloads/Modul1\" -o \"merged_output.pdf\" -l \"eng+ind\" -e \".jpeg\" -c -r \"1-58\" Parameters:\n-i or --input_dir: Path to the directory containing the images. -o or --output_pdf: Name for the merged PDF file. -l or --languages: Languages for OCR, separated by +. -e or --extension: Image file extension to process. -c or --cleanup: If set, the script will delete individual PDFs after merging. -r or --range: Range of image numbers to process (e.g., 1-58). Example:\npython convert_and_merge.py -i \"C:/Users/marve/Downloads/Modul1\" -o \"combined_document.pdf\" -l \"eng+ind\" -e \".jpeg\" -c -r \"1-58\" 7.2. Final Checks Log File: Review convert_and_merge.log for detailed logs and errors. Final PDF: Open combined_document.pdf to ensure all pages are present and searchable. Cleanup: If the -c flag was used, verify that individual PDFs have been deleted. 8. Conclusion You’ve successfully built a Python application that automates the conversion of multiple images to searchable PDFs using Tesseract OCR and merges them into a single PDF. This script is modular, flexible, and can be enhanced further based on your needs.\nNext Steps: Advanced Error Handling:\nImplement retries for failed OCR conversions. Handle different image orientations or formats. User Interface:\nDevelop a GUI for non-technical users. Performance Optimization:\nParallelize OCR processes for faster execution on multi-core systems. Packaging:\nPackage the script into an executable using tools like PyInstaller for easy distribution. Integration:\nIntegrate with cloud storage or other services for automated workflows. Feel free to customize and expand the script based on your specific requirements. If you encounter any challenges or have further questions, don’t hesitate to ask!\nHappy coding!\n","wordCount":"3150","inLanguage":"en","image":"http://labrat-vm:1313/%3Cimage%20path/url%3E","datePublished":"2025-02-04T07:39:28Z","dateModified":"2025-02-04T07:39:28Z","author":{"@type":"Person","name":"lisianthus"},"mainEntityOfPage":{"@type":"WebPage","@id":"http://labrat-vm:1313/posts/my-first-post/"},"publisher":{"@type":"Organization","name":"Labrat","logo":{"@type":"ImageObject","url":"http://labrat-vm:1313/%3Clink%20/%20abs%20url%3E"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=http://labrat-vm:1313/ accesskey=h title="labraaat (Alt + H)"><img src=http://labrat-vm:1313/apple-touch-icon.png alt aria-label=logo height=35>labraaat</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=http://labrat-vm:1313/posts/ title=posts><span>posts</span></a></li><li><a href=http://labrat-vm:1313/tags/ title=tags><span>tags</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=http://labrat-vm:1313/>Home</a>&nbsp;»&nbsp;<a href=http://labrat-vm:1313/posts/>Posts</a></div><h1 class="post-title entry-hint-parent">Reverse PDF Universitas Terbuka Modul</h1><div class=post-description>Desc Text.</div><div class=post-meta><span title='2025-02-04 07:39:28 +0000 +0000'>February 4, 2025</span>&nbsp;·&nbsp;3150 words&nbsp;·&nbsp;lisianthus&nbsp;|&nbsp;<a href=https://github.com/%3cpath_to_repo%3e/content/posts/my-first-post.md rel="noopener noreferrer" target=_blank>Suggest Changes</a></div></header><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><nav id=TableOfContents><ul><li><a href=#1-setting-up-your-environment><strong>1. Setting Up Your Environment</strong></a><ul><li><a href=#11-install-python><strong>1.1. Install Python</strong></a></li><li><a href=#12-install-an-integrated-development-environment-ide><strong>1.2. Install an Integrated Development Environment (IDE)</strong></a></li></ul></li><li><a href=#2-installing-required-software-and-python-packages><strong>2. Installing Required Software and Python Packages</strong></a><ul><li><a href=#21-install-tesseract-ocr><strong>2.1. Install Tesseract OCR</strong></a></li><li><a href=#22-install-language-data-files><strong>2.2. Install Language Data Files</strong></a></li><li><a href=#23-set-up-a-python-virtual-environment-optional-but-recommended><strong>2.3. Set Up a Python Virtual Environment (Optional but Recommended)</strong></a></li><li><a href=#24-install-required-python-packages><strong>2.4. Install Required Python Packages</strong></a></li></ul></li><li><a href=#3-understanding-the-workflow><strong>3. Understanding the Workflow</strong></a></li><li><a href=#4-writing-the-python-script><strong>4. Writing the Python Script</strong></a><ul><li><a href=#41-script-structure><strong>4.1. Script Structure</strong></a></li><li><a href=#42-writing-the-script><strong>4.2. Writing the Script</strong></a></li><li><a href=#43-script-explanation><strong>4.3. Script Explanation</strong></a></li><li><a href=#44-important-considerations><strong>4.4. Important Considerations</strong></a></li></ul></li><li><a href=#5-enhancements-and-best-practices><strong>5. Enhancements and Best Practices</strong></a><ul><li><a href=#51-command-line-arguments><strong>5.1. Command-Line Arguments</strong></a></li><li><a href=#52-logging><strong>5.2. Logging</strong></a></li><li><a href=#53-gui-implementation-optional><strong>5.3. GUI Implementation (Optional)</strong></a></li></ul></li><li><a href=#6-testing-and-troubleshooting><strong>6. Testing and Troubleshooting</strong></a><ul><li><a href=#61-running-the-script><strong>6.1. Running the Script</strong></a></li><li><a href=#62-common-issues-and-solutions><strong>6.2. Common Issues and Solutions</strong></a></li><li><a href=#63-verifying-output><strong>6.3. Verifying Output</strong></a></li></ul></li><li><a href=#7-final-thoughts-and-best-practices><strong>7. Final Thoughts and Best Practices</strong></a></li><li><a href=#complete-enhanced-script-with-command-line-arguments-and-logging><strong>Complete Enhanced Script with Command-Line Arguments and Logging</strong></a><ul><li><a href=#71-running-the-enhanced-script><strong>7.1. Running the Enhanced Script</strong></a></li><li><a href=#72-final-checks><strong>7.2. Final Checks</strong></a></li></ul></li><li><a href=#8-conclusion><strong>8. Conclusion</strong></a><ul><li><a href=#next-steps><strong>Next Steps:</strong></a></li></ul></li></ul></nav></div></details></div><div class=post-content><p>Below, I&rsquo;ll guide you through the entire process step-by-step, covering:</p><ol><li><strong>Setting Up Your Environment</strong></li><li><strong>Installing Required Software and Python Packages</strong></li><li><strong>Understanding the Workflow</strong></li><li><strong>Writing the Python Script</strong></li><li><strong>Enhancements and Best Practices</strong></li><li><strong>Testing and Troubleshooting</strong></li></ol><p>Let’s get started!</p><hr><h2 id=1-setting-up-your-environment><strong>1. Setting Up Your Environment</strong><a hidden class=anchor aria-hidden=true href=#1-setting-up-your-environment>#</a></h2><p>Before diving into coding, ensure that your development environment is correctly set up.</p><h3 id=11-install-python><strong>1.1. Install Python</strong><a hidden class=anchor aria-hidden=true href=#11-install-python>#</a></h3><p>If you haven&rsquo;t installed Python yet:</p><ul><li><p><strong>Download Python:</strong></p><ul><li>Visit the <a href=https://www.python.org/downloads/>official Python website</a> and download the latest stable release.</li><li>It&rsquo;s recommended to install Python 3.7 or higher.</li></ul></li><li><p><strong>During Installation:</strong></p><ul><li><strong>Windows:</strong> Ensure you check the box <strong>&ldquo;Add Python to PATH&rdquo;</strong>. This makes it easier to run Python and pip from the command line.</li><li>Follow the prompts to complete the installation.</li></ul></li><li><p><strong>Verify Installation:</strong></p><p>Open <strong>Command Prompt</strong> or <strong>PowerShell</strong> and run:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>python --version
</span></span></code></pre></div><p>You should see something like:</p><pre tabindex=0><code>Python 3.11.4
</code></pre></li></ul><h3 id=12-install-an-integrated-development-environment-ide><strong>1.2. Install an Integrated Development Environment (IDE)</strong><a hidden class=anchor aria-hidden=true href=#12-install-an-integrated-development-environment-ide>#</a></h3><p>While not mandatory, an IDE can significantly enhance your productivity. Here are some popular choices:</p><ul><li><strong><a href=https://code.visualstudio.com/>Visual Studio Code</a>:</strong> Lightweight and highly customizable.</li><li><strong><a href=https://www.jetbrains.com/pycharm/>PyCharm</a>:</strong> Feature-rich, especially for larger projects.</li><li><strong><a href=https://atom.io/>Atom</a>:</strong> Simple and hackable text editor.</li></ul><p><em>For this guide, we&rsquo;ll assume you&rsquo;re using Visual Studio Code (VS Code).</em></p><hr><h2 id=2-installing-required-software-and-python-packages><strong>2. Installing Required Software and Python Packages</strong><a hidden class=anchor aria-hidden=true href=#2-installing-required-software-and-python-packages>#</a></h2><h3 id=21-install-tesseract-ocr><strong>2.1. Install Tesseract OCR</strong><a hidden class=anchor aria-hidden=true href=#21-install-tesseract-ocr>#</a></h3><p>Tesseract is essential for OCR operations.</p><ul><li><p><strong>Download Tesseract:</strong></p><ul><li>Visit the <a href=https://github.com/tesseract-ocr/tesseract>Tesseract OCR GitHub repository</a>.</li><li>For Windows users, you can directly download the installer from <a href=https://github.com/UB-Mannheim/tesseract/wiki>UB Mannheim&rsquo;s Tesseract builds</a>.</li></ul></li><li><p><strong>Installation Steps (Windows):</strong></p><ol><li>Run the installer.</li><li>During installation, note the installation path (e.g., <code>C:\Program Files\Tesseract-OCR\</code>).</li><li>Ensure that the installer adds Tesseract to your system’s PATH. If not, you&rsquo;ll need to add it manually:<ul><li><strong>Manually Adding to PATH:</strong><ul><li>Right-click on <strong>This PC</strong> > <strong>Properties</strong> > <strong>Advanced system settings</strong>.</li><li>Click on <strong>Environment Variables</strong>.</li><li>Under <strong>System variables</strong>, find and select <strong>Path</strong>, then click <strong>Edit</strong>.</li><li>Click <strong>New</strong> and add the path to your Tesseract installation (e.g., <code>C:\Program Files\Tesseract-OCR\</code>).</li><li>Click <strong>OK</strong> to save.</li></ul></li></ul></li></ol></li><li><p><strong>Verify Installation:</strong></p><p>Open <strong>Command Prompt</strong> or <strong>PowerShell</strong> and run:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>tesseract --version
</span></span></code></pre></div><p>You should see version information, e.g.:</p><pre tabindex=0><code>tesseract v5.3.0
</code></pre></li></ul><h3 id=22-install-language-data-files><strong>2.2. Install Language Data Files</strong><a hidden class=anchor aria-hidden=true href=#22-install-language-data-files>#</a></h3><p>Since you need support for English (<code>eng</code>) and Indonesian (<code>ind</code>):</p><ul><li><p><strong>Download Language Data:</strong></p><ul><li>The language data files (trained data) are usually included by default.</li><li>However, to ensure you have both English and Indonesian, you can download them from <a href=https://github.com/tesseract-ocr/tessdata>Tesseract&rsquo;s tessdata repository</a>.</li></ul></li><li><p><strong>Place Language Files:</strong></p><ul><li>Copy <code>eng.traineddata</code> and <code>ind.traineddata</code> to Tesseract’s <code>tessdata</code> directory (e.g., <code>C:\Program Files\Tesseract-OCR\tessdata\</code>).</li></ul></li></ul><h3 id=23-set-up-a-python-virtual-environment-optional-but-recommended><strong>2.3. Set Up a Python Virtual Environment (Optional but Recommended)</strong><a hidden class=anchor aria-hidden=true href=#23-set-up-a-python-virtual-environment-optional-but-recommended>#</a></h3><p>Using a virtual environment isolates your project’s dependencies.</p><ol><li><p><strong>Navigate to Your Project Directory:</strong></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>mkdir C:<span class=se>\U</span>sers<span class=se>\m</span>arve<span class=se>\D</span>ownloads<span class=se>\M</span>odul1
</span></span><span class=line><span class=cl><span class=nb>cd</span> C:<span class=se>\U</span>sers<span class=se>\m</span>arve<span class=se>\D</span>ownloads<span class=se>\M</span>odul1
</span></span></code></pre></div></li><li><p><strong>Create a Virtual Environment:</strong></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>python -m venv venv
</span></span></code></pre></div></li><li><p><strong>Activate the Virtual Environment:</strong></p><ul><li><p><strong>Windows:</strong></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>.<span class=se>\v</span>env<span class=se>\S</span>cripts<span class=se>\a</span>ctivate
</span></span></code></pre></div></li><li><p><strong>PowerShell:</strong></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-powershell data-lang=powershell><span class=line><span class=cl><span class=p>.\</span><span class=n>venv</span><span class=p>\</span><span class=n>Scripts</span><span class=p>\</span><span class=n>Activate</span><span class=p>.</span><span class=py>ps1</span>
</span></span></code></pre></div></li><li><p><strong>Unix or MacOS:</strong></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=nb>source</span> venv/bin/activate
</span></span></code></pre></div></li></ul></li><li><p><strong>Verify Activation:</strong></p><p>Your prompt should change to indicate that the virtual environment is active, e.g., <code>(venv) C:\Users\marve\Downloads\Modul1></code></p></li></ol><h3 id=24-install-required-python-packages><strong>2.4. Install Required Python Packages</strong><a hidden class=anchor aria-hidden=true href=#24-install-required-python-packages>#</a></h3><p>We&rsquo;ll need several Python libraries:</p><ul><li><strong><code>pytesseract</code>:</strong> Python wrapper for Tesseract OCR.</li><li><strong><code>Pillow</code>:</strong> For image processing.</li><li><strong><code>PyPDF2</code> or <code>pdfmerge</code>:</strong> For merging PDFs.</li><li><strong><code>tqdm</code>:</strong> For progress bars (optional but useful).</li></ul><p><strong>Install via pip:</strong></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>pip install pytesseract Pillow PyPDF2 tqdm
</span></span></code></pre></div><p><em>Note:</em> <code>PyPDF2</code> is a popular library for PDF manipulation. Alternatively, you can use <code>pdfrw</code>, <code>pdfminer</code>, or others based on specific needs.</p><hr><h2 id=3-understanding-the-workflow><strong>3. Understanding the Workflow</strong><a hidden class=anchor aria-hidden=true href=#3-understanding-the-workflow>#</a></h2><p>Before writing code, it&rsquo;s crucial to understand the steps involved:</p><ol><li><p><strong>Locate Image Files:</strong></p><ul><li>Identify all images (e.g., <code>1.jpeg</code> to <code>58.jpeg</code>) within a specified directory.</li></ul></li><li><p><strong>Convert Images to Searchable PDFs:</strong></p><ul><li>For each image:<ul><li>Use Tesseract to perform OCR, specifying appropriate languages.</li><li>Save the output as an individual PDF.</li></ul></li></ul></li><li><p><strong>Merge Individual PDFs into a Single PDF:</strong></p><ul><li>Combine all individual PDFs into one comprehensive PDF, maintaining the correct order.</li></ul></li><li><p><strong>Cleanup (Optional):</strong></p><ul><li>Remove individual PDFs if only the merged PDF is needed.</li></ul></li></ol><hr><h2 id=4-writing-the-python-script><strong>4. Writing the Python Script</strong><a hidden class=anchor aria-hidden=true href=#4-writing-the-python-script>#</a></h2><p>We&rsquo;ll create a Python script named <code>convert_and_merge.py</code> that accomplishes the tasks mentioned above.</p><h3 id=41-script-structure><strong>4.1. Script Structure</strong><a hidden class=anchor aria-hidden=true href=#41-script-structure>#</a></h3><p>We&rsquo;ll structure the script into functions for better readability and maintenance:</p><ul><li><code>convert_image_to_pdf(image_path, output_pdf_path, languages)</code>: Converts a single image to a searchable PDF.</li><li><code>merge_pdfs(pdf_paths, output_path)</code>: Merges a list of PDFs into a single PDF.</li><li><code>main()</code>: Orchestrates the entire process.</li></ul><h3 id=42-writing-the-script><strong>4.2. Writing the Script</strong><a hidden class=anchor aria-hidden=true href=#42-writing-the-script>#</a></h3><p>Create a new file named <code>convert_and_merge.py</code> in your project directory and open it in your IDE.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># convert_and_merge.py</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>os</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>sys</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>subprocess</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>pathlib</span> <span class=kn>import</span> <span class=n>Path</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>typing</span> <span class=kn>import</span> <span class=n>List</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>pytesseract</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>PIL</span> <span class=kn>import</span> <span class=n>Image</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>PyPDF2</span> <span class=kn>import</span> <span class=n>PdfMerger</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>tqdm</span> <span class=kn>import</span> <span class=n>tqdm</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>convert_image_to_pdf</span><span class=p>(</span><span class=n>image_path</span><span class=p>:</span> <span class=n>Path</span><span class=p>,</span> <span class=n>output_pdf_path</span><span class=p>:</span> <span class=n>Path</span><span class=p>,</span> <span class=n>languages</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=s2>&#34;eng+ind&#34;</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;
</span></span></span><span class=line><span class=cl><span class=s2>    Converts an image to a searchable PDF using Tesseract OCR.
</span></span></span><span class=line><span class=cl><span class=s2>
</span></span></span><span class=line><span class=cl><span class=s2>    Args:
</span></span></span><span class=line><span class=cl><span class=s2>        image_path (Path): Path to the input image.
</span></span></span><span class=line><span class=cl><span class=s2>        output_pdf_path (Path): Path to save the output PDF.
</span></span></span><span class=line><span class=cl><span class=s2>        languages (str, optional): Languages for Tesseract OCR. Defaults to &#34;eng+ind&#34;.
</span></span></span><span class=line><span class=cl><span class=s2>    &#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=k>try</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=c1># Ensure the image exists</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=ow>not</span> <span class=n>image_path</span><span class=o>.</span><span class=n>exists</span><span class=p>():</span>
</span></span><span class=line><span class=cl>            <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Image file </span><span class=si>{</span><span class=n>image_path</span><span class=si>}</span><span class=s2> does not exist.&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=c1># Construct the Tesseract command</span>
</span></span><span class=line><span class=cl>        <span class=c1># tesseract input_image output_base -l lang --dpi 300 pdf</span>
</span></span><span class=line><span class=cl>        <span class=c1># We use &#39;--dpi 300&#39; to specify resolution; adjust as needed</span>
</span></span><span class=line><span class=cl>        <span class=c1># The output_pdf_path should not have the .pdf extension in the second parameter</span>
</span></span><span class=line><span class=cl>        <span class=n>command</span> <span class=o>=</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;tesseract&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=nb>str</span><span class=p>(</span><span class=n>image_path</span><span class=p>),</span>
</span></span><span class=line><span class=cl>            <span class=nb>str</span><span class=p>(</span><span class=n>output_pdf_path</span><span class=o>.</span><span class=n>with_suffix</span><span class=p>(</span><span class=s1>&#39;&#39;</span><span class=p>)),</span>  <span class=c1># Tesseract appends .pdf</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;-l&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=n>languages</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;pdf&#39;</span>
</span></span><span class=line><span class=cl>        <span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=c1># Run the Tesseract command</span>
</span></span><span class=line><span class=cl>        <span class=n>subprocess</span><span class=o>.</span><span class=n>run</span><span class=p>(</span><span class=n>command</span><span class=p>,</span> <span class=n>check</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span> <span class=n>stdout</span><span class=o>=</span><span class=n>subprocess</span><span class=o>.</span><span class=n>PIPE</span><span class=p>,</span> <span class=n>stderr</span><span class=o>=</span><span class=n>subprocess</span><span class=o>.</span><span class=n>PIPE</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>except</span> <span class=n>subprocess</span><span class=o>.</span><span class=n>CalledProcessError</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Error processing </span><span class=si>{</span><span class=n>image_path</span><span class=si>}</span><span class=s2>: </span><span class=si>{</span><span class=n>e</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>except</span> <span class=ne>Exception</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Unexpected error processing </span><span class=si>{</span><span class=n>image_path</span><span class=si>}</span><span class=s2>: </span><span class=si>{</span><span class=n>e</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>merge_pdfs</span><span class=p>(</span><span class=n>pdf_paths</span><span class=p>:</span> <span class=n>List</span><span class=p>[</span><span class=n>Path</span><span class=p>],</span> <span class=n>output_path</span><span class=p>:</span> <span class=n>Path</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;
</span></span></span><span class=line><span class=cl><span class=s2>    Merges multiple PDFs into a single PDF.
</span></span></span><span class=line><span class=cl><span class=s2>
</span></span></span><span class=line><span class=cl><span class=s2>    Args:
</span></span></span><span class=line><span class=cl><span class=s2>        pdf_paths (List[Path]): List of PDF file paths to merge.
</span></span></span><span class=line><span class=cl><span class=s2>        output_path (Path): Path to save the merged PDF.
</span></span></span><span class=line><span class=cl><span class=s2>    &#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=n>merger</span> <span class=o>=</span> <span class=n>PdfMerger</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>try</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=n>pdf</span> <span class=ow>in</span> <span class=n>pdf_paths</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=n>pdf</span><span class=o>.</span><span class=n>exists</span><span class=p>():</span>
</span></span><span class=line><span class=cl>                <span class=n>merger</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=nb>str</span><span class=p>(</span><span class=n>pdf</span><span class=p>))</span>
</span></span><span class=line><span class=cl>            <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;PDF file </span><span class=si>{</span><span class=n>pdf</span><span class=si>}</span><span class=s2> does not exist and will be skipped.&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=c1># Write out the merged PDF</span>
</span></span><span class=line><span class=cl>        <span class=n>merger</span><span class=o>.</span><span class=n>write</span><span class=p>(</span><span class=nb>str</span><span class=p>(</span><span class=n>output_path</span><span class=p>))</span>
</span></span><span class=line><span class=cl>        <span class=n>merger</span><span class=o>.</span><span class=n>close</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=k>except</span> <span class=ne>Exception</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Error merging PDFs: </span><span class=si>{</span><span class=n>e</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>merger</span><span class=o>.</span><span class=n>close</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>main</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;
</span></span></span><span class=line><span class=cl><span class=s2>    Main function to convert images to PDFs and merge them.
</span></span></span><span class=line><span class=cl><span class=s2>    &#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=c1># Define the directory containing images</span>
</span></span><span class=line><span class=cl>    <span class=n>images_dir</span> <span class=o>=</span> <span class=n>Path</span><span class=p>(</span><span class=s2>&#34;C:/Users/marve/Downloads/Modul1&#34;</span><span class=p>)</span>  <span class=c1># Adjust as needed</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># Define the output merged PDF path</span>
</span></span><span class=line><span class=cl>    <span class=n>merged_pdf_path</span> <span class=o>=</span> <span class=n>images_dir</span> <span class=o>/</span> <span class=s2>&#34;combined_document.pdf&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># Define languages for OCR</span>
</span></span><span class=line><span class=cl>    <span class=n>languages</span> <span class=o>=</span> <span class=s2>&#34;eng+ind&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># Define the range of images or pattern</span>
</span></span><span class=line><span class=cl>    <span class=c1># Here, assuming images are named as 1.jpeg to 58.jpeg</span>
</span></span><span class=line><span class=cl>    <span class=n>image_files</span> <span class=o>=</span> <span class=p>[</span><span class=n>images_dir</span> <span class=o>/</span> <span class=sa>f</span><span class=s2>&#34;</span><span class=si>{</span><span class=n>i</span><span class=si>}</span><span class=s2>.jpeg&#34;</span> <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span> <span class=mi>59</span><span class=p>)]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># Define a list to store individual PDF paths</span>
</span></span><span class=line><span class=cl>    <span class=n>individual_pdfs</span> <span class=o>=</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;Starting conversion of images to PDFs...&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>image_path</span> <span class=ow>in</span> <span class=n>tqdm</span><span class=p>(</span><span class=n>image_files</span><span class=p>,</span> <span class=n>desc</span><span class=o>=</span><span class=s2>&#34;Converting Images&#34;</span><span class=p>,</span> <span class=n>unit</span><span class=o>=</span><span class=s2>&#34;image&#34;</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=n>output_pdf</span> <span class=o>=</span> <span class=n>image_path</span><span class=o>.</span><span class=n>with_suffix</span><span class=p>(</span><span class=s1>&#39;.pdf&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>convert_image_to_pdf</span><span class=p>(</span><span class=n>image_path</span><span class=p>,</span> <span class=n>output_pdf</span><span class=p>,</span> <span class=n>languages</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>output_pdf</span><span class=o>.</span><span class=n>exists</span><span class=p>():</span>
</span></span><span class=line><span class=cl>            <span class=n>individual_pdfs</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>output_pdf</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;Converting complete.</span><span class=se>\n</span><span class=s2>Starting merging of PDFs...&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># Sort PDFs based on numerical order</span>
</span></span><span class=line><span class=cl>    <span class=n>individual_pdfs_sorted</span> <span class=o>=</span> <span class=nb>sorted</span><span class=p>(</span><span class=n>individual_pdfs</span><span class=p>,</span> <span class=n>key</span><span class=o>=</span><span class=k>lambda</span> <span class=n>x</span><span class=p>:</span> <span class=nb>int</span><span class=p>(</span><span class=n>x</span><span class=o>.</span><span class=n>stem</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># Merge PDFs</span>
</span></span><span class=line><span class=cl>    <span class=n>merge_pdfs</span><span class=p>(</span><span class=n>individual_pdfs_sorted</span><span class=p>,</span> <span class=n>merged_pdf_path</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Merged PDF saved as </span><span class=si>{</span><span class=n>merged_pdf_path</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;</span><span class=se>\n</span><span class=s2>Optional: Cleaning up individual PDF files.&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=c1># Uncomment the following lines if you want to delete individual PDFs after merging</span>
</span></span><span class=line><span class=cl>    <span class=c1># for pdf in individual_pdfs_sorted:</span>
</span></span><span class=line><span class=cl>    <span class=c1>#     try:</span>
</span></span><span class=line><span class=cl>    <span class=c1>#         pdf.unlink()</span>
</span></span><span class=line><span class=cl>    <span class=c1>#         print(f&#34;Deleted {pdf}&#34;)</span>
</span></span><span class=line><span class=cl>    <span class=c1>#     except Exception as e:</span>
</span></span><span class=line><span class=cl>    <span class=c1>#         print(f&#34;Error deleting {pdf}: {e}&#34;)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;Process completed successfully!&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=vm>__name__</span> <span class=o>==</span> <span class=s2>&#34;__main__&#34;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>main</span><span class=p>()</span>
</span></span></code></pre></div><h3 id=43-script-explanation><strong>4.3. Script Explanation</strong><a hidden class=anchor aria-hidden=true href=#43-script-explanation>#</a></h3><ol><li><p><strong>Imports:</strong></p><ul><li><strong><code>os, sys, subprocess</code>:</strong> For interacting with the system and running external commands.</li><li><strong><code>Path</code> from <code>pathlib</code>:</strong> For convenient path manipulations.</li><li><strong><code>List</code> from <code>typing</code>:</strong> For type hinting.</li><li><strong><code>pytesseract, PIL.Image</code>:</strong> For image processing and OCR (though in this script, <code>pytesseract</code> isn&rsquo;t directly used; Tesseract is called via <code>subprocess</code>).</li><li><strong><code>PyPDF2.PdfMerger</code>:</strong> To merge PDFs.</li><li><strong><code>tqdm</code>:</strong> For displaying progress bars.</li></ul></li><li><p><strong><code>convert_image_to_pdf</code> Function:</strong></p><ul><li>Constructs and runs the Tesseract command to convert an image to a searchable PDF.</li><li>Checks if the input image exists.</li><li>Handles exceptions and provides feedback on errors.</li></ul></li><li><p><strong><code>merge_pdfs</code> Function:</strong></p><ul><li>Uses <code>PyPDF2.PdfMerger</code> to append each PDF in the correct order.</li><li>Skips any missing PDFs and informs the user.</li><li>Writes the merged PDF to the specified <code>output_path</code>.</li></ul></li><li><p><strong><code>main</code> Function:</strong></p><ul><li>Defines the directory containing images and the output path for the merged PDF.</li><li>Specifies the OCR languages (<code>eng+ind</code> for English and Indonesian).</li><li>Generates a list of image file paths (<code>1.jpeg</code> to <code>58.jpeg</code>).</li><li>Iterates through each image, converting them to PDFs while displaying a progress bar.</li><li>Sorts the individual PDFs numerically to maintain order.</li><li>Merges all PDFs into a single document.</li><li>Optionally, cleans up individual PDF files after merging (currently commented out).</li></ul></li><li><p><strong>Execution:</strong></p><ul><li>The script runs the <code>main()</code> function when executed directly.</li></ul></li></ol><h3 id=44-important-considerations><strong>4.4. Important Considerations</strong><a hidden class=anchor aria-hidden=true href=#44-important-considerations>#</a></h3><ul><li><p><strong>Tesseract&rsquo;s Output Handling:</strong></p><ul><li>Tesseract appends the <code>.pdf</code> extension automatically. Therefore, when specifying the output base name, you should omit the <code>.pdf</code> suffix in the second argument.</li></ul></li><li><p><strong>Error Handling:</strong></p><ul><li>The script includes basic error handling. Depending on your use case, you might want to enhance this (e.g., logging errors to a file).</li></ul></li><li><p><strong>Progress Feedback:</strong></p><ul><li>The <code>tqdm</code> library provides a neat progress bar during the conversion process, enhancing user experience.</li></ul></li><li><p><strong>Cleanup Process:</strong></p><ul><li>After merging, you might not need individual PDF files. The script includes an optional cleanup section that you can enable by uncommenting the relevant lines.</li></ul></li></ul><hr><h2 id=5-enhancements-and-best-practices><strong>5. Enhancements and Best Practices</strong><a hidden class=anchor aria-hidden=true href=#5-enhancements-and-best-practices>#</a></h2><p>To make your application more robust and user-friendly, consider implementing the following enhancements:</p><h3 id=51-command-line-arguments><strong>5.1. Command-Line Arguments</strong><a hidden class=anchor aria-hidden=true href=#51-command-line-arguments>#</a></h3><p>Allow users to specify parameters like input directory, output file name, language options, etc.</p><p><strong>Implementation:</strong></p><p>Use the <code>argparse</code> module to parse command-line arguments.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>argparse</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>parse_arguments</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=n>parser</span> <span class=o>=</span> <span class=n>argparse</span><span class=o>.</span><span class=n>ArgumentParser</span><span class=p>(</span><span class=n>description</span><span class=o>=</span><span class=s2>&#34;Convert images to searchable PDF and merge them.&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>parser</span><span class=o>.</span><span class=n>add_argument</span><span class=p>(</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;-i&#39;</span><span class=p>,</span> <span class=s1>&#39;--input_dir&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=nb>type</span><span class=o>=</span><span class=nb>str</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=n>default</span><span class=o>=</span><span class=s2>&#34;C:/Users/marve/Downloads/Modul1&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=n>help</span><span class=o>=</span><span class=s1>&#39;Directory containing input images.&#39;</span>
</span></span><span class=line><span class=cl>    <span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>parser</span><span class=o>.</span><span class=n>add_argument</span><span class=p>(</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;-o&#39;</span><span class=p>,</span> <span class=s1>&#39;--output_pdf&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=nb>type</span><span class=o>=</span><span class=nb>str</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=n>default</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=n>help</span><span class=o>=</span><span class=s1>&#39;Filename for the merged output PDF. Defaults to &#34;combined_document.pdf&#34;.&#39;</span>
</span></span><span class=line><span class=cl>    <span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>parser</span><span class=o>.</span><span class=n>add_argument</span><span class=p>(</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;-l&#39;</span><span class=p>,</span> <span class=s1>&#39;--languages&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=nb>type</span><span class=o>=</span><span class=nb>str</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=n>default</span><span class=o>=</span><span class=s2>&#34;eng+ind&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=n>help</span><span class=o>=</span><span class=s1>&#39;Languages for OCR separated by +, e.g., &#34;eng+ind&#34;.&#39;</span>
</span></span><span class=line><span class=cl>    <span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>parser</span><span class=o>.</span><span class=n>add_argument</span><span class=p>(</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;-e&#39;</span><span class=p>,</span> <span class=s1>&#39;--extension&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=nb>type</span><span class=o>=</span><span class=nb>str</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=n>default</span><span class=o>=</span><span class=s2>&#34;.jpeg&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=n>help</span><span class=o>=</span><span class=s1>&#39;Image file extension to process, e.g., &#34;.jpeg&#34;, &#34;.jpg&#34;, &#34;.png&#34;.&#39;</span>
</span></span><span class=line><span class=cl>    <span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>parser</span><span class=o>.</span><span class=n>add_argument</span><span class=p>(</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;-c&#39;</span><span class=p>,</span> <span class=s1>&#39;--cleanup&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=n>action</span><span class=o>=</span><span class=s1>&#39;store_true&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=n>help</span><span class=o>=</span><span class=s1>&#39;Cleanup individual PDFs after merging.&#39;</span>
</span></span><span class=line><span class=cl>    <span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>parser</span><span class=o>.</span><span class=n>add_argument</span><span class=p>(</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;-r&#39;</span><span class=p>,</span> <span class=s1>&#39;--range&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=nb>type</span><span class=o>=</span><span class=nb>str</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=n>default</span><span class=o>=</span><span class=s2>&#34;1-58&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=n>help</span><span class=o>=</span><span class=s1>&#39;Range of image numbers to process, e.g., &#34;1-58&#34;.&#39;</span>
</span></span><span class=line><span class=cl>    <span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>parser</span><span class=o>.</span><span class=n>parse_args</span><span class=p>()</span>
</span></span></code></pre></div><p><strong>Integrate into <code>main()</code>:</strong></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=k>def</span> <span class=nf>main</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=n>args</span> <span class=o>=</span> <span class=n>parse_arguments</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># Define the directory containing images</span>
</span></span><span class=line><span class=cl>    <span class=n>images_dir</span> <span class=o>=</span> <span class=n>Path</span><span class=p>(</span><span class=n>args</span><span class=o>.</span><span class=n>input_dir</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># Define the output merged PDF path</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>args</span><span class=o>.</span><span class=n>output_pdf</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>merged_pdf_path</span> <span class=o>=</span> <span class=n>images_dir</span> <span class=o>/</span> <span class=n>args</span><span class=o>.</span><span class=n>output_pdf</span>
</span></span><span class=line><span class=cl>    <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>merged_pdf_path</span> <span class=o>=</span> <span class=n>images_dir</span> <span class=o>/</span> <span class=s2>&#34;combined_document.pdf&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># Define languages for OCR</span>
</span></span><span class=line><span class=cl>    <span class=n>languages</span> <span class=o>=</span> <span class=n>args</span><span class=o>.</span><span class=n>languages</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># Define the range of images</span>
</span></span><span class=line><span class=cl>    <span class=k>try</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>start</span><span class=p>,</span> <span class=n>end</span> <span class=o>=</span> <span class=nb>map</span><span class=p>(</span><span class=nb>int</span><span class=p>,</span> <span class=n>args</span><span class=o>.</span><span class=n>range</span><span class=o>.</span><span class=n>split</span><span class=p>(</span><span class=s1>&#39;-&#39;</span><span class=p>))</span>
</span></span><span class=line><span class=cl>        <span class=n>image_files</span> <span class=o>=</span> <span class=p>[</span><span class=n>images_dir</span> <span class=o>/</span> <span class=sa>f</span><span class=s2>&#34;</span><span class=si>{</span><span class=n>i</span><span class=si>}{</span><span class=n>args</span><span class=o>.</span><span class=n>extension</span><span class=si>}</span><span class=s2>&#34;</span> <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=n>start</span><span class=p>,</span> <span class=n>end</span> <span class=o>+</span> <span class=mi>1</span><span class=p>)]</span>
</span></span><span class=line><span class=cl>    <span class=k>except</span> <span class=ne>ValueError</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;Invalid range format. Use start-end, e.g., 1-58.&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>sys</span><span class=o>.</span><span class=n>exit</span><span class=p>(</span><span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># Define a list to store individual PDF paths</span>
</span></span><span class=line><span class=cl>    <span class=n>individual_pdfs</span> <span class=o>=</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;Starting conversion of images to PDFs...&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>image_path</span> <span class=ow>in</span> <span class=n>tqdm</span><span class=p>(</span><span class=n>image_files</span><span class=p>,</span> <span class=n>desc</span><span class=o>=</span><span class=s2>&#34;Converting Images&#34;</span><span class=p>,</span> <span class=n>unit</span><span class=o>=</span><span class=s2>&#34;image&#34;</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=n>output_pdf</span> <span class=o>=</span> <span class=n>image_path</span><span class=o>.</span><span class=n>with_suffix</span><span class=p>(</span><span class=s1>&#39;.pdf&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>convert_image_to_pdf</span><span class=p>(</span><span class=n>image_path</span><span class=p>,</span> <span class=n>output_pdf</span><span class=p>,</span> <span class=n>languages</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>output_pdf</span><span class=o>.</span><span class=n>exists</span><span class=p>():</span>
</span></span><span class=line><span class=cl>            <span class=n>individual_pdfs</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>output_pdf</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;Converting complete.</span><span class=se>\n</span><span class=s2>Starting merging of PDFs...&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># Sort PDFs based on numerical order</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>extract_number</span><span class=p>(</span><span class=n>pdf</span><span class=p>:</span> <span class=n>Path</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>int</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>try</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=nb>int</span><span class=p>(</span><span class=n>pdf</span><span class=o>.</span><span class=n>stem</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>except</span> <span class=ne>ValueError</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=mi>0</span>  <span class=c1># Or handle differently</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>individual_pdfs_sorted</span> <span class=o>=</span> <span class=nb>sorted</span><span class=p>(</span><span class=n>individual_pdfs</span><span class=p>,</span> <span class=n>key</span><span class=o>=</span><span class=n>extract_number</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># Merge PDFs</span>
</span></span><span class=line><span class=cl>    <span class=n>merge_pdfs</span><span class=p>(</span><span class=n>individual_pdfs_sorted</span><span class=p>,</span> <span class=n>merged_pdf_path</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Merged PDF saved as </span><span class=si>{</span><span class=n>merged_pdf_path</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>args</span><span class=o>.</span><span class=n>cleanup</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;</span><span class=se>\n</span><span class=s2>Cleaning up individual PDF files.&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=n>pdf</span> <span class=ow>in</span> <span class=n>individual_pdfs_sorted</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>try</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=n>pdf</span><span class=o>.</span><span class=n>unlink</span><span class=p>()</span>
</span></span><span class=line><span class=cl>                <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Deleted </span><span class=si>{</span><span class=n>pdf</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=k>except</span> <span class=ne>Exception</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Error deleting </span><span class=si>{</span><span class=n>pdf</span><span class=si>}</span><span class=s2>: </span><span class=si>{</span><span class=n>e</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;Process completed successfully!&#34;</span><span class=p>)</span>
</span></span></code></pre></div><p><strong>Benefits:</strong></p><ul><li>Enhanced flexibility.</li><li>Users can specify custom parameters without modifying the script.</li></ul><h3 id=52-logging><strong>5.2. Logging</strong><a hidden class=anchor aria-hidden=true href=#52-logging>#</a></h3><p>Implement logging to record the process details, especially useful for debugging.</p><p><strong>Implementation:</strong></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>logging</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>setup_logging</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=n>logging</span><span class=o>.</span><span class=n>basicConfig</span><span class=p>(</span>
</span></span><span class=line><span class=cl>        <span class=n>filename</span><span class=o>=</span><span class=s1>&#39;convert_and_merge.log&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=n>filemode</span><span class=o>=</span><span class=s1>&#39;a&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=nb>format</span><span class=o>=</span><span class=s1>&#39;</span><span class=si>%(asctime)s</span><span class=s1> - </span><span class=si>%(levelname)s</span><span class=s1> - </span><span class=si>%(message)s</span><span class=s1>&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=n>level</span><span class=o>=</span><span class=n>logging</span><span class=o>.</span><span class=n>INFO</span>
</span></span><span class=line><span class=cl>    <span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Update functions to use logging</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>convert_image_to_pdf</span><span class=p>(</span><span class=n>image_path</span><span class=p>:</span> <span class=n>Path</span><span class=p>,</span> <span class=n>output_pdf_path</span><span class=p>:</span> <span class=n>Path</span><span class=p>,</span> <span class=n>languages</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=s2>&#34;eng+ind&#34;</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>try</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=ow>not</span> <span class=n>image_path</span><span class=o>.</span><span class=n>exists</span><span class=p>():</span>
</span></span><span class=line><span class=cl>            <span class=n>logging</span><span class=o>.</span><span class=n>warning</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Image file </span><span class=si>{</span><span class=n>image_path</span><span class=si>}</span><span class=s2> does not exist.&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=n>command</span> <span class=o>=</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;tesseract&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=nb>str</span><span class=p>(</span><span class=n>image_path</span><span class=p>),</span>
</span></span><span class=line><span class=cl>            <span class=nb>str</span><span class=p>(</span><span class=n>output_pdf_path</span><span class=o>.</span><span class=n>with_suffix</span><span class=p>(</span><span class=s1>&#39;&#39;</span><span class=p>)),</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;-l&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=n>languages</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;pdf&#39;</span>
</span></span><span class=line><span class=cl>        <span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=n>subprocess</span><span class=o>.</span><span class=n>run</span><span class=p>(</span><span class=n>command</span><span class=p>,</span> <span class=n>check</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span> <span class=n>stdout</span><span class=o>=</span><span class=n>subprocess</span><span class=o>.</span><span class=n>PIPE</span><span class=p>,</span> <span class=n>stderr</span><span class=o>=</span><span class=n>subprocess</span><span class=o>.</span><span class=n>PIPE</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>logging</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Converted </span><span class=si>{</span><span class=n>image_path</span><span class=si>}</span><span class=s2> to </span><span class=si>{</span><span class=n>output_pdf_path</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>except</span> <span class=n>subprocess</span><span class=o>.</span><span class=n>CalledProcessError</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>logging</span><span class=o>.</span><span class=n>error</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Error processing </span><span class=si>{</span><span class=n>image_path</span><span class=si>}</span><span class=s2>: </span><span class=si>{</span><span class=n>e</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>except</span> <span class=ne>Exception</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>logging</span><span class=o>.</span><span class=n>error</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Unexpected error processing </span><span class=si>{</span><span class=n>image_path</span><span class=si>}</span><span class=s2>: </span><span class=si>{</span><span class=n>e</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>merge_pdfs</span><span class=p>(</span><span class=n>pdf_paths</span><span class=p>:</span> <span class=n>List</span><span class=p>[</span><span class=n>Path</span><span class=p>],</span> <span class=n>output_path</span><span class=p>:</span> <span class=n>Path</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>merger</span> <span class=o>=</span> <span class=n>PdfMerger</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>try</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=n>pdf</span> <span class=ow>in</span> <span class=n>pdf_paths</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=n>pdf</span><span class=o>.</span><span class=n>exists</span><span class=p>():</span>
</span></span><span class=line><span class=cl>                <span class=n>merger</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=nb>str</span><span class=p>(</span><span class=n>pdf</span><span class=p>))</span>
</span></span><span class=line><span class=cl>                <span class=n>logging</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Appended </span><span class=si>{</span><span class=n>pdf</span><span class=si>}</span><span class=s2> to merger.&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=n>logging</span><span class=o>.</span><span class=n>warning</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;PDF file </span><span class=si>{</span><span class=n>pdf</span><span class=si>}</span><span class=s2> does not exist and will be skipped.&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=n>merger</span><span class=o>.</span><span class=n>write</span><span class=p>(</span><span class=nb>str</span><span class=p>(</span><span class=n>output_path</span><span class=p>))</span>
</span></span><span class=line><span class=cl>        <span class=n>merger</span><span class=o>.</span><span class=n>close</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=n>logging</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Merged PDF saved as </span><span class=si>{</span><span class=n>output_path</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>except</span> <span class=ne>Exception</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>logging</span><span class=o>.</span><span class=n>error</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Error merging PDFs: </span><span class=si>{</span><span class=n>e</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>merger</span><span class=o>.</span><span class=n>close</span><span class=p>()</span>
</span></span></code></pre></div><p><strong>Benefits:</strong></p><ul><li>Persistent records of the application&rsquo;s operations.</li><li>Easier identification and troubleshooting of issues.</li></ul><h3 id=53-gui-implementation-optional><strong>5.3. GUI Implementation (Optional)</strong><a hidden class=anchor aria-hidden=true href=#53-gui-implementation-optional>#</a></h3><p>For users who prefer a graphical interface, you can enhance the application using libraries like <code>tkinter</code>, <code>PyQt</code>, or <code>Kivy</code>.</p><p><em>Given the scope, we&rsquo;ll skip GUI implementation in this guide, but feel free to explore it based on your needs.</em></p><hr><h2 id=6-testing-and-troubleshooting><strong>6. Testing and Troubleshooting</strong><a hidden class=anchor aria-hidden=true href=#6-testing-and-troubleshooting>#</a></h2><h3 id=61-running-the-script><strong>6.1. Running the Script</strong><a hidden class=anchor aria-hidden=true href=#61-running-the-script>#</a></h3><ol><li><p><strong>Ensure Virtual Environment is Activated (if using one):</strong></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>.<span class=se>\v</span>env<span class=se>\S</span>cripts<span class=se>\a</span>ctivate
</span></span></code></pre></div></li><li><p><strong>Navigate to Script Directory:</strong></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=nb>cd</span> C:<span class=se>\U</span>sers<span class=se>\m</span>arve<span class=se>\D</span>ownloads<span class=se>\M</span>odul1
</span></span></code></pre></div></li><li><p><strong>Run the Script:</strong></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>python convert_and_merge.py
</span></span></code></pre></div><p><em>Or, if you&rsquo;ve implemented command-line arguments:</em></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>python convert_and_merge.py -i <span class=s2>&#34;C:/Users/marve/Downloads/Modul1&#34;</span> -o <span class=s2>&#34;combined_document.pdf&#34;</span> -l <span class=s2>&#34;eng+ind&#34;</span> -e <span class=s2>&#34;.jpeg&#34;</span> -c -r <span class=s2>&#34;1-58&#34;</span>
</span></span></code></pre></div></li></ol><h3 id=62-common-issues-and-solutions><strong>6.2. Common Issues and Solutions</strong><a hidden class=anchor aria-hidden=true href=#62-common-issues-and-solutions>#</a></h3><ol><li><p><strong><code>tesseract</code> Not Recognized:</strong></p><ul><li><strong>Issue:</strong> The system can&rsquo;t find the <code>tesseract</code> command.</li><li><strong>Solution:</strong> Ensure Tesseract is installed and added to the system&rsquo;s PATH. Verify by running <code>tesseract --version</code> in the command line.</li></ul></li><li><p><strong>Incorrect Image Paths:</strong></p><ul><li><strong>Issue:</strong> The script can&rsquo;t find image files.</li><li><strong>Solution:</strong> Ensure that image files are named correctly and placed in the specified directory. Verify the file extensions.</li></ul></li><li><p><strong>Language Data Not Found:</strong></p><ul><li><strong>Issue:</strong> Tesseract reports missing language data for specified languages.</li><li><strong>Solution:</strong> Confirm that the necessary <code>.traineddata</code> files (e.g., <code>eng.traineddata</code>, <code>ind.traineddata</code>) are present in Tesseract&rsquo;s <code>tessdata</code> directory.</li></ul></li><li><p><strong>Permission Errors:</strong></p><ul><li><strong>Issue:</strong> The script lacks permissions to read/write files.</li><li><strong>Solution:</strong> Run the script with appropriate permissions. On Windows, ensure that your user account has read/write access to the target directory.</li></ul></li><li><p><strong>Large Files or Memory Issues:</strong></p><ul><li><strong>Issue:</strong> Processing large images or numerous files may consume significant memory.</li><li><strong>Solution:</strong> Optimize images before processing (e.g., reduce resolution/resizing if possible). Monitor system resources during execution.</li></ul></li></ol><h3 id=63-verifying-output><strong>6.3. Verifying Output</strong><a hidden class=anchor aria-hidden=true href=#63-verifying-output>#</a></h3><ul><li><p><strong>Individual PDFs:</strong></p><ul><li>Open a few converted PDFs (e.g., <code>1.pdf</code>, <code>2.pdf</code>) to ensure that:<ul><li>The PDF displays the image correctly.</li><li>The text is selectable/searchable, indicating successful OCR.</li></ul></li></ul></li><li><p><strong>Merged PDF:</strong></p><ul><li>Open <code>combined_document.pdf</code> and navigate through the pages to confirm that:<ul><li>All pages are included in the correct order.</li><li>The searchable text layer functions as expected.</li></ul></li></ul></li></ul><hr><h2 id=7-final-thoughts-and-best-practices><strong>7. Final Thoughts and Best Practices</strong><a hidden class=anchor aria-hidden=true href=#7-final-thoughts-and-best-practices>#</a></h2><ol><li><p><strong>Backup Your Data:</strong></p><ul><li>Before running bulk operations, especially those that modify or delete files, ensure you have backups.</li></ul></li><li><p><strong>Handle Different Image Formats:</strong></p><ul><li>Extend the script to handle multiple image formats (<code>.jpg</code>, <code>.png</code>, etc.) by adjusting the <code>extension</code> parameter or using pattern matching.</li></ul></li><li><p><strong>Optimize OCR Settings:</strong></p><ul><li>Depending on your images, you might need to adjust DPI settings or perform pre-processing (e.g., grayscale conversion, noise reduction) to improve OCR accuracy.</li></ul></li><li><p><strong>Error Logging:</strong></p><ul><li>Continuous logging helps in monitoring the application&rsquo;s performance and diagnosing issues.</li></ul></li><li><p><strong>Scalability:</strong></p><ul><li>For processing a large number of images or large-sized files, consider implementing multithreading or multiprocessing to speed up the process.</li></ul></li><li><p><strong>User Feedback:</strong></p><ul><li>Incorporate more detailed feedback, such as estimated time remaining or summaries of processed files.</li></ul></li><li><p><strong>Packaging:</strong></p><ul><li>For distribution, consider packaging the script using tools like <code>PyInstaller</code> to create an executable.</li></ul></li></ol><hr><h2 id=complete-enhanced-script-with-command-line-arguments-and-logging><strong>Complete Enhanced Script with Command-Line Arguments and Logging</strong><a hidden class=anchor aria-hidden=true href=#complete-enhanced-script-with-command-line-arguments-and-logging>#</a></h2><p>Here&rsquo;s the enhanced version of <code>convert_and_merge.py</code> incorporating command-line arguments and logging:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># convert_and_merge.py</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>os</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>sys</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>subprocess</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>pathlib</span> <span class=kn>import</span> <span class=n>Path</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>typing</span> <span class=kn>import</span> <span class=n>List</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>argparse</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>logging</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>pytesseract</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>PIL</span> <span class=kn>import</span> <span class=n>Image</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>PyPDF2</span> <span class=kn>import</span> <span class=n>PdfMerger</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>tqdm</span> <span class=kn>import</span> <span class=n>tqdm</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>setup_logging</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=n>logging</span><span class=o>.</span><span class=n>basicConfig</span><span class=p>(</span>
</span></span><span class=line><span class=cl>        <span class=n>filename</span><span class=o>=</span><span class=s1>&#39;convert_and_merge.log&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=n>filemode</span><span class=o>=</span><span class=s1>&#39;a&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=nb>format</span><span class=o>=</span><span class=s1>&#39;</span><span class=si>%(asctime)s</span><span class=s1> - </span><span class=si>%(levelname)s</span><span class=s1> - </span><span class=si>%(message)s</span><span class=s1>&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=n>level</span><span class=o>=</span><span class=n>logging</span><span class=o>.</span><span class=n>INFO</span>
</span></span><span class=line><span class=cl>    <span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>parse_arguments</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=n>parser</span> <span class=o>=</span> <span class=n>argparse</span><span class=o>.</span><span class=n>ArgumentParser</span><span class=p>(</span><span class=n>description</span><span class=o>=</span><span class=s2>&#34;Convert images to searchable PDF and merge them.&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>parser</span><span class=o>.</span><span class=n>add_argument</span><span class=p>(</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;-i&#39;</span><span class=p>,</span> <span class=s1>&#39;--input_dir&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=nb>type</span><span class=o>=</span><span class=nb>str</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=n>default</span><span class=o>=</span><span class=s2>&#34;C:/Users/marve/Downloads/Modul1&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=n>help</span><span class=o>=</span><span class=s1>&#39;Directory containing input images.&#39;</span>
</span></span><span class=line><span class=cl>    <span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>parser</span><span class=o>.</span><span class=n>add_argument</span><span class=p>(</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;-o&#39;</span><span class=p>,</span> <span class=s1>&#39;--output_pdf&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=nb>type</span><span class=o>=</span><span class=nb>str</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=n>default</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=n>help</span><span class=o>=</span><span class=s1>&#39;Filename for the merged output PDF. Defaults to &#34;combined_document.pdf&#34;.&#39;</span>
</span></span><span class=line><span class=cl>    <span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>parser</span><span class=o>.</span><span class=n>add_argument</span><span class=p>(</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;-l&#39;</span><span class=p>,</span> <span class=s1>&#39;--languages&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=nb>type</span><span class=o>=</span><span class=nb>str</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=n>default</span><span class=o>=</span><span class=s2>&#34;eng+ind&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=n>help</span><span class=o>=</span><span class=s1>&#39;Languages for OCR separated by +, e.g., &#34;eng+ind&#34;.&#39;</span>
</span></span><span class=line><span class=cl>    <span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>parser</span><span class=o>.</span><span class=n>add_argument</span><span class=p>(</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;-e&#39;</span><span class=p>,</span> <span class=s1>&#39;--extension&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=nb>type</span><span class=o>=</span><span class=nb>str</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=n>default</span><span class=o>=</span><span class=s2>&#34;.jpeg&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=n>help</span><span class=o>=</span><span class=s1>&#39;Image file extension to process, e.g., &#34;.jpeg&#34;, &#34;.jpg&#34;, &#34;.png&#34;.&#39;</span>
</span></span><span class=line><span class=cl>    <span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>parser</span><span class=o>.</span><span class=n>add_argument</span><span class=p>(</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;-c&#39;</span><span class=p>,</span> <span class=s1>&#39;--cleanup&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=n>action</span><span class=o>=</span><span class=s1>&#39;store_true&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=n>help</span><span class=o>=</span><span class=s1>&#39;Cleanup individual PDFs after merging.&#39;</span>
</span></span><span class=line><span class=cl>    <span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>parser</span><span class=o>.</span><span class=n>add_argument</span><span class=p>(</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;-r&#39;</span><span class=p>,</span> <span class=s1>&#39;--range&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=nb>type</span><span class=o>=</span><span class=nb>str</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=n>default</span><span class=o>=</span><span class=s2>&#34;1-58&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=n>help</span><span class=o>=</span><span class=s1>&#39;Range of image numbers to process, e.g., &#34;1-58&#34;.&#39;</span>
</span></span><span class=line><span class=cl>    <span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>parser</span><span class=o>.</span><span class=n>parse_args</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>convert_image_to_pdf</span><span class=p>(</span><span class=n>image_path</span><span class=p>:</span> <span class=n>Path</span><span class=p>,</span> <span class=n>output_pdf_path</span><span class=p>:</span> <span class=n>Path</span><span class=p>,</span> <span class=n>languages</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=s2>&#34;eng+ind&#34;</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;
</span></span></span><span class=line><span class=cl><span class=s2>    Converts an image to a searchable PDF using Tesseract OCR.
</span></span></span><span class=line><span class=cl><span class=s2>
</span></span></span><span class=line><span class=cl><span class=s2>    Args:
</span></span></span><span class=line><span class=cl><span class=s2>        image_path (Path): Path to the input image.
</span></span></span><span class=line><span class=cl><span class=s2>        output_pdf_path (Path): Path to save the output PDF.
</span></span></span><span class=line><span class=cl><span class=s2>        languages (str, optional): Languages for Tesseract OCR. Defaults to &#34;eng+ind&#34;.
</span></span></span><span class=line><span class=cl><span class=s2>    &#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=k>try</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=ow>not</span> <span class=n>image_path</span><span class=o>.</span><span class=n>exists</span><span class=p>():</span>
</span></span><span class=line><span class=cl>            <span class=n>logging</span><span class=o>.</span><span class=n>warning</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Image file </span><span class=si>{</span><span class=n>image_path</span><span class=si>}</span><span class=s2> does not exist.&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=n>command</span> <span class=o>=</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;tesseract&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=nb>str</span><span class=p>(</span><span class=n>image_path</span><span class=p>),</span>
</span></span><span class=line><span class=cl>            <span class=nb>str</span><span class=p>(</span><span class=n>output_pdf_path</span><span class=o>.</span><span class=n>with_suffix</span><span class=p>(</span><span class=s1>&#39;&#39;</span><span class=p>)),</span>  <span class=c1># Tesseract appends .pdf</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;-l&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=n>languages</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;pdf&#39;</span>
</span></span><span class=line><span class=cl>        <span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=n>subprocess</span><span class=o>.</span><span class=n>run</span><span class=p>(</span><span class=n>command</span><span class=p>,</span> <span class=n>check</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span> <span class=n>stdout</span><span class=o>=</span><span class=n>subprocess</span><span class=o>.</span><span class=n>PIPE</span><span class=p>,</span> <span class=n>stderr</span><span class=o>=</span><span class=n>subprocess</span><span class=o>.</span><span class=n>PIPE</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>logging</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Converted </span><span class=si>{</span><span class=n>image_path</span><span class=si>}</span><span class=s2> to </span><span class=si>{</span><span class=n>output_pdf_path</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>except</span> <span class=n>subprocess</span><span class=o>.</span><span class=n>CalledProcessError</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>logging</span><span class=o>.</span><span class=n>error</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Error processing </span><span class=si>{</span><span class=n>image_path</span><span class=si>}</span><span class=s2>: </span><span class=si>{</span><span class=n>e</span><span class=o>.</span><span class=n>stderr</span><span class=o>.</span><span class=n>decode</span><span class=p>()</span><span class=o>.</span><span class=n>strip</span><span class=p>()</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>except</span> <span class=ne>Exception</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>logging</span><span class=o>.</span><span class=n>error</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Unexpected error processing </span><span class=si>{</span><span class=n>image_path</span><span class=si>}</span><span class=s2>: </span><span class=si>{</span><span class=n>e</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>merge_pdfs</span><span class=p>(</span><span class=n>pdf_paths</span><span class=p>:</span> <span class=n>List</span><span class=p>[</span><span class=n>Path</span><span class=p>],</span> <span class=n>output_path</span><span class=p>:</span> <span class=n>Path</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;
</span></span></span><span class=line><span class=cl><span class=s2>    Merges multiple PDFs into a single PDF.
</span></span></span><span class=line><span class=cl><span class=s2>
</span></span></span><span class=line><span class=cl><span class=s2>    Args:
</span></span></span><span class=line><span class=cl><span class=s2>        pdf_paths (List[Path]): List of PDF file paths to merge.
</span></span></span><span class=line><span class=cl><span class=s2>        output_path (Path): Path to save the merged PDF.
</span></span></span><span class=line><span class=cl><span class=s2>    &#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=n>merger</span> <span class=o>=</span> <span class=n>PdfMerger</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>try</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=n>pdf</span> <span class=ow>in</span> <span class=n>pdf_paths</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=n>pdf</span><span class=o>.</span><span class=n>exists</span><span class=p>():</span>
</span></span><span class=line><span class=cl>                <span class=n>merger</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=nb>str</span><span class=p>(</span><span class=n>pdf</span><span class=p>))</span>
</span></span><span class=line><span class=cl>                <span class=n>logging</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Appended </span><span class=si>{</span><span class=n>pdf</span><span class=si>}</span><span class=s2> to merger.&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=n>logging</span><span class=o>.</span><span class=n>warning</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;PDF file </span><span class=si>{</span><span class=n>pdf</span><span class=si>}</span><span class=s2> does not exist and will be skipped.&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=n>merger</span><span class=o>.</span><span class=n>write</span><span class=p>(</span><span class=nb>str</span><span class=p>(</span><span class=n>output_path</span><span class=p>))</span>
</span></span><span class=line><span class=cl>        <span class=n>merger</span><span class=o>.</span><span class=n>close</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=n>logging</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Merged PDF saved as </span><span class=si>{</span><span class=n>output_path</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>except</span> <span class=ne>Exception</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>logging</span><span class=o>.</span><span class=n>error</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Error merging PDFs: </span><span class=si>{</span><span class=n>e</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>merger</span><span class=o>.</span><span class=n>close</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>main</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;
</span></span></span><span class=line><span class=cl><span class=s2>    Main function to convert images to PDFs and merge them.
</span></span></span><span class=line><span class=cl><span class=s2>    &#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=n>setup_logging</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=n>args</span> <span class=o>=</span> <span class=n>parse_arguments</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># Define the directory containing images</span>
</span></span><span class=line><span class=cl>    <span class=n>images_dir</span> <span class=o>=</span> <span class=n>Path</span><span class=p>(</span><span class=n>args</span><span class=o>.</span><span class=n>input_dir</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># Define the output merged PDF path</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>args</span><span class=o>.</span><span class=n>output_pdf</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>merged_pdf_path</span> <span class=o>=</span> <span class=n>images_dir</span> <span class=o>/</span> <span class=n>args</span><span class=o>.</span><span class=n>output_pdf</span>
</span></span><span class=line><span class=cl>    <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>merged_pdf_path</span> <span class=o>=</span> <span class=n>images_dir</span> <span class=o>/</span> <span class=s2>&#34;combined_document.pdf&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># Define languages for OCR</span>
</span></span><span class=line><span class=cl>    <span class=n>languages</span> <span class=o>=</span> <span class=n>args</span><span class=o>.</span><span class=n>languages</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># Define the range of images</span>
</span></span><span class=line><span class=cl>    <span class=k>try</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>start</span><span class=p>,</span> <span class=n>end</span> <span class=o>=</span> <span class=nb>map</span><span class=p>(</span><span class=nb>int</span><span class=p>,</span> <span class=n>args</span><span class=o>.</span><span class=n>range</span><span class=o>.</span><span class=n>split</span><span class=p>(</span><span class=s1>&#39;-&#39;</span><span class=p>))</span>
</span></span><span class=line><span class=cl>        <span class=n>image_files</span> <span class=o>=</span> <span class=p>[</span><span class=n>images_dir</span> <span class=o>/</span> <span class=sa>f</span><span class=s2>&#34;</span><span class=si>{</span><span class=n>i</span><span class=si>}{</span><span class=n>args</span><span class=o>.</span><span class=n>extension</span><span class=si>}</span><span class=s2>&#34;</span> <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=n>start</span><span class=p>,</span> <span class=n>end</span> <span class=o>+</span> <span class=mi>1</span><span class=p>)]</span>
</span></span><span class=line><span class=cl>    <span class=k>except</span> <span class=ne>ValueError</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;Invalid range format. Use start-end, e.g., 1-58.&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>logging</span><span class=o>.</span><span class=n>error</span><span class=p>(</span><span class=s2>&#34;Invalid range format provided.&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>sys</span><span class=o>.</span><span class=n>exit</span><span class=p>(</span><span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># Define a list to store individual PDF paths</span>
</span></span><span class=line><span class=cl>    <span class=n>individual_pdfs</span> <span class=o>=</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;Starting conversion of images to PDFs...&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>logging</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=s2>&#34;Starting conversion of images to PDFs.&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>image_path</span> <span class=ow>in</span> <span class=n>tqdm</span><span class=p>(</span><span class=n>image_files</span><span class=p>,</span> <span class=n>desc</span><span class=o>=</span><span class=s2>&#34;Converting Images&#34;</span><span class=p>,</span> <span class=n>unit</span><span class=o>=</span><span class=s2>&#34;image&#34;</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=n>output_pdf</span> <span class=o>=</span> <span class=n>image_path</span><span class=o>.</span><span class=n>with_suffix</span><span class=p>(</span><span class=s1>&#39;.pdf&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>convert_image_to_pdf</span><span class=p>(</span><span class=n>image_path</span><span class=p>,</span> <span class=n>output_pdf</span><span class=p>,</span> <span class=n>languages</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>output_pdf</span><span class=o>.</span><span class=n>exists</span><span class=p>():</span>
</span></span><span class=line><span class=cl>            <span class=n>individual_pdfs</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>output_pdf</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;Converting complete.</span><span class=se>\n</span><span class=s2>Starting merging of PDFs...&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>logging</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=s2>&#34;Conversion complete. Starting merging of PDFs.&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># Sort PDFs based on numerical order</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>extract_number</span><span class=p>(</span><span class=n>pdf</span><span class=p>:</span> <span class=n>Path</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>int</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>try</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=nb>int</span><span class=p>(</span><span class=n>pdf</span><span class=o>.</span><span class=n>stem</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>except</span> <span class=ne>ValueError</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>logging</span><span class=o>.</span><span class=n>warning</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Non-numeric PDF filename: </span><span class=si>{</span><span class=n>pdf</span><span class=o>.</span><span class=n>name</span><span class=si>}</span><span class=s2>. Assigning sorting key 0.&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=mi>0</span>  <span class=c1># Or handle differently</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>individual_pdfs_sorted</span> <span class=o>=</span> <span class=nb>sorted</span><span class=p>(</span><span class=n>individual_pdfs</span><span class=p>,</span> <span class=n>key</span><span class=o>=</span><span class=n>extract_number</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># Merge PDFs</span>
</span></span><span class=line><span class=cl>    <span class=n>merge_pdfs</span><span class=p>(</span><span class=n>individual_pdfs_sorted</span><span class=p>,</span> <span class=n>merged_pdf_path</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Merged PDF saved as </span><span class=si>{</span><span class=n>merged_pdf_path</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>logging</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Merged PDF saved as </span><span class=si>{</span><span class=n>merged_pdf_path</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>args</span><span class=o>.</span><span class=n>cleanup</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;</span><span class=se>\n</span><span class=s2>Cleaning up individual PDF files.&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>logging</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=s2>&#34;Starting cleanup of individual PDF files.&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=n>pdf</span> <span class=ow>in</span> <span class=n>individual_pdfs_sorted</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>try</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=n>pdf</span><span class=o>.</span><span class=n>unlink</span><span class=p>()</span>
</span></span><span class=line><span class=cl>                <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Deleted </span><span class=si>{</span><span class=n>pdf</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                <span class=n>logging</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Deleted </span><span class=si>{</span><span class=n>pdf</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=k>except</span> <span class=ne>Exception</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Error deleting </span><span class=si>{</span><span class=n>pdf</span><span class=si>}</span><span class=s2>: </span><span class=si>{</span><span class=n>e</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                <span class=n>logging</span><span class=o>.</span><span class=n>error</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Error deleting </span><span class=si>{</span><span class=n>pdf</span><span class=si>}</span><span class=s2>: </span><span class=si>{</span><span class=n>e</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;Process completed successfully!&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>logging</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=s2>&#34;Process completed successfully.&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=vm>__name__</span> <span class=o>==</span> <span class=s2>&#34;__main__&#34;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>main</span><span class=p>()</span>
</span></span></code></pre></div><h3 id=71-running-the-enhanced-script><strong>7.1. Running the Enhanced Script</strong><a hidden class=anchor aria-hidden=true href=#71-running-the-enhanced-script>#</a></h3><p><strong>Command-Line Usage:</strong></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>python convert_and_merge.py -i <span class=s2>&#34;C:/Users/marve/Downloads/Modul1&#34;</span> -o <span class=s2>&#34;merged_output.pdf&#34;</span> -l <span class=s2>&#34;eng+ind&#34;</span> -e <span class=s2>&#34;.jpeg&#34;</span> -c -r <span class=s2>&#34;1-58&#34;</span>
</span></span></code></pre></div><p><strong>Parameters:</strong></p><ul><li><code>-i</code> or <code>--input_dir</code>: Path to the directory containing the images.</li><li><code>-o</code> or <code>--output_pdf</code>: Name for the merged PDF file.</li><li><code>-l</code> or <code>--languages</code>: Languages for OCR, separated by <code>+</code>.</li><li><code>-e</code> or <code>--extension</code>: Image file extension to process.</li><li><code>-c</code> or <code>--cleanup</code>: If set, the script will delete individual PDFs after merging.</li><li><code>-r</code> or <code>--range</code>: Range of image numbers to process (e.g., <code>1-58</code>).</li></ul><p><strong>Example:</strong></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>python convert_and_merge.py -i <span class=s2>&#34;C:/Users/marve/Downloads/Modul1&#34;</span> -o <span class=s2>&#34;combined_document.pdf&#34;</span> -l <span class=s2>&#34;eng+ind&#34;</span> -e <span class=s2>&#34;.jpeg&#34;</span> -c -r <span class=s2>&#34;1-58&#34;</span>
</span></span></code></pre></div><h3 id=72-final-checks><strong>7.2. Final Checks</strong><a hidden class=anchor aria-hidden=true href=#72-final-checks>#</a></h3><ul><li><strong>Log File:</strong> Review <code>convert_and_merge.log</code> for detailed logs and errors.</li><li><strong>Final PDF:</strong> Open <code>combined_document.pdf</code> to ensure all pages are present and searchable.</li><li><strong>Cleanup:</strong> If the <code>-c</code> flag was used, verify that individual PDFs have been deleted.</li></ul><hr><h2 id=8-conclusion><strong>8. Conclusion</strong><a hidden class=anchor aria-hidden=true href=#8-conclusion>#</a></h2><p>You&rsquo;ve successfully built a Python application that automates the conversion of multiple images to searchable PDFs using Tesseract OCR and merges them into a single PDF. This script is modular, flexible, and can be enhanced further based on your needs.</p><h3 id=next-steps><strong>Next Steps:</strong><a hidden class=anchor aria-hidden=true href=#next-steps>#</a></h3><ol><li><p><strong>Advanced Error Handling:</strong></p><ul><li>Implement retries for failed OCR conversions.</li><li>Handle different image orientations or formats.</li></ul></li><li><p><strong>User Interface:</strong></p><ul><li>Develop a GUI for non-technical users.</li></ul></li><li><p><strong>Performance Optimization:</strong></p><ul><li>Parallelize OCR processes for faster execution on multi-core systems.</li></ul></li><li><p><strong>Packaging:</strong></p><ul><li>Package the script into an executable using tools like <code>PyInstaller</code> for easy distribution.</li></ul></li><li><p><strong>Integration:</strong></p><ul><li>Integrate with cloud storage or other services for automated workflows.</li></ul></li></ol><p>Feel free to customize and expand the script based on your specific requirements. If you encounter any challenges or have further questions, don&rsquo;t hesitate to ask!</p><p>Happy coding!</p></div><footer class=post-footer><ul class=post-tags><li><a href=http://labrat-vm:1313/tags/first/>First</a></li></ul></footer></article></main><footer class=footer><span>&copy; 2025 <a href=http://labrat-vm:1313/>Labrat</a></span> ·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script></body></html>